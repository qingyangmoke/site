/*!
 * tinyjs-plugin-dragonbones
 * Description: Tiny 骨骼动画
 * Author: 采东 <qingyangmoke@qq.com>
 * Version: v0.0.1
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.DragonBones=e():(t.Tiny=t.Tiny||{},t.Tiny.DragonBones=e())}(this,function(){return function(t){function e(a){if(i[a])return i[a].exports;var r=i[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="/dist",e(0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationState=e.Animation=e.Armature=e.WorldClock=e.BaseFactory=e.BaseObject=e.Bone=e.buildArmatureDisplay=e.addTextureAtlasData=e.addDragonBonesData=e.TinyFactory=e.BoundingBoxType=e.BlendMode=e.DisplayType=e.TinySlot=e.TinyTextureAtlasData=e.TinyTextureData=e.TinyArmatureDisplay=void 0;var r=i(2),n=a(r),s=i(3),o=a(s),l=i(5),h=a(l),u=i(6),_=a(u),f=i(7),c=a(f),m=i(9),p=a(m),d=i(8),y=a(d),g=i(4),v=a(g),b=i(10),T=a(b),D=i(18),O=n.default.BaseObject,x=n.default.BaseFactory,S=n.default.WorldClock,w=n.default.Armature,E=n.default.Animation,A=n.default.AnimationState,M=n.default.Bone;e.TinyArmatureDisplay=o.default,e.TinyTextureData=_.default,e.TinyTextureAtlasData=h.default,e.TinySlot=c.default,e.DisplayType=p.default,e.BlendMode=y.default,e.BoundingBoxType=v.default,e.TinyFactory=T.default,e.addDragonBonesData=D.addDragonBonesData,e.addTextureAtlasData=D.addTextureAtlasData,e.buildArmatureDisplay=D.buildArmatureDisplay,e.Bone=M,e.BaseObject=O,e.BaseFactory=x,e.WorldClock=S,e.Armature=w,e.Animation=E,e.AnimationState=A},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();!function(t){var e=function(){function t(){}return t.hasArmature=function(e){return t._armatures.indexOf(e)>=0},t.addArmature=function(e){e&&t._armatures.indexOf(e)<0&&t._armatures.push(e)},t.removeArmature=function(e){if(e){var i=t._armatures.indexOf(e);i>=0&&t._armatures.splice(i,1)}},t}();e.PI_D=2*Math.PI,e.PI_H=Math.PI/2,e.PI_Q=Math.PI/4,e.ANGLE_TO_RADIAN=Math.PI/180,e.RADIAN_TO_ANGLE=180/Math.PI,e.SECOND_TO_MILLISECOND=1e3,e.NO_TWEEN=100,e.VERSION="5.0.0",e.ARGUMENT_ERROR="Argument error.",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e._armatures=[],t.DragonBones=e}(i||(i={}));var i;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++,this._isInPool=!1}return t._returnObject=function(e){var i=String(e.constructor),a=null==t._maxCountMap[i]?t._defaultMaxCount:t._maxCountMap[i],r=t._poolsMap[i]=t._poolsMap[i]||[];r.length<a&&(e._isInPool||r.push(e))},t.setMaxCount=function(e,i){if((i<0||i!==i)&&(i=0),e){var a=String(e);t._maxCountMap[a]=i;var r=t._poolsMap[a];r&&r.length>i&&(r.length=i)}else{t._defaultMaxCount=i;for(var a in t._poolsMap)if(null!=t._maxCountMap[a]){t._maxCountMap[a]=i;var r=t._poolsMap[a];r.length>i&&(r.length=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var i=t._poolsMap[String(e)];i&&i.length&&(i.length=0)}else for(var a in t._poolsMap){var i=t._poolsMap[a];i.length=0}},t.borrowObject=function(e){var i=t._poolsMap[String(e)];if(i&&i.length>0){var a=i.pop();return a._isInPool=!1,a}var a=new e;return a._onClear(),a},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t}();e._hashCode=0,e._defaultMaxCount=5e3,e._maxCountMap={},e._poolsMap={},t.BaseObject=e}(i||(i={}));var i;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(i||(i={}));var i;!function(t){var e=function(){function t(t,e,i,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),this.x=t,this.y=e,this.width=i,this.height=a}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(i||(i={}));var i;!function(t){var e=function(){function e(t,e,i,a,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===r&&(r=1),void 0===n&&(n=1),this.x=t,this.y=e,this.skewX=i,this.skewY=a,this.scaleX=r,this.scaleY=n}return e.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},e.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},e.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},e.prototype.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},e.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skewX=e.normalizeRadian(this.skewX-t.skewX),this.skewY=e.normalizeRadian(this.skewY-t.skewY),this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},e.prototype.fromMatrix=function(i){this.x=i.tx,this.y=i.ty,this.skewX=Math.atan(-i.c/i.d),this.skewY=Math.atan(i.b/i.a);var a=this.scaleX,r=this.scaleY,n=t.DragonBones.PI_Q,s=this.skewX-this.skewY,o=Math.cos(this.skewX),l=Math.sin(this.skewX);return-.01<s&&s<.01?this.scaleX=this.skewY>-n&&this.skewY<n?i.a/o:i.b/l:this.scaleX=this.skewY>-n&&this.skewY<n?i.a/Math.cos(this.skewY):i.b/Math.sin(this.skewY),this.scaleY=this.skewX>-n&&this.skewX<n?i.d/o:-i.c/l,a>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.skewY=e.normalizeRadian(this.skewY-Math.PI)),r>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.skewX=e.normalizeRadian(this.skewX-Math.PI)),this},e.prototype.toMatrix=function(t){if(0!==this.skewX||0!==this.skewY){t.a=Math.cos(this.skewY),t.b=Math.sin(this.skewY);var e=this.skewX-this.skewY;-.01<e&&e<.01?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skewX),t.d=Math.cos(this.skewX)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY)}else t.a=this.scaleX,t.b=0,t.c=0,t.d=this.scaleY;return t.tx=this.x,t.ty=this.y,this},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.scaleX>=0?this.skewY:this.skewY+Math.PI},set:function(t){var e=this.scaleX>=0?t-this.skewY:t-this.skewY-Math.PI;this.skewX+=e,this.skewY+=e},enumerable:!0,configurable:!0}),e}();t.Transform=e}(i||(i={}));var i;!function(t){var e=function(){function t(t,e,i,a,r,n){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=1),void 0===r&&(r=0),void 0===n&&(n=0),this.a=t,this.b=e,this.c=i,this.d=a,this.tx=r,this.ty=n}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},t.prototype.concat=function(t){var e=this.a*t.a,i=0,a=0,r=this.d*t.d,n=this.tx*t.a+t.tx,s=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,a+=this.c*t.a,r+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,a+=this.d*t.c,n+=this.ty*t.c,s+=this.tx*t.b),this.a=e,this.b=i,this.c=a,this.d=r,this.tx=n,this.ty=s,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,a=this.d,r=this.tx,n=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===a?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,a=this.d=1/a,this.tx=-t*r,this.ty=-a*n),this;var s=t*a-e*i;if(0===s)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;s=1/s;var o=this.a=a*s;return e=this.b=-e*s,i=this.c=-i*s,a=this.d=t*s,this.tx=-(o*r+i*n),this.ty=-(e*r+a*n),this},t.prototype.transformPoint=function(t,e,i,a){void 0===a&&(a=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,a||(i.x+=this.tx,i.y+=this.ty)},t}();t.Matrix=e}(i||(i={}));var i;!function(t){var e=function(){function t(t,e,i,a,r,n,s,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===a&&(a=1),void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=a,this.alphaOffset=r,this.redOffset=n,this.greenOffset=s,this.blueOffset=o}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(i||(i={}));var i;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.boneMask=[],e.animationNames=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.AnimationConfig]"},e.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTime=-1,this.fadeOutEasing=0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.actionEnabled=!0,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.fadeInEasing=0,this.weight=1,this.name=null,this.animation=null,this.group=null,this.boneMask.length=0,this.animationNames.length=0},e.prototype.clear=function(){this._onClear()},e.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutEasing=t.fadeOutEasing,this.additiveBlending=t.additiveBlending,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.actionEnabled=t.actionEnabled,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInEasing=t.fadeInEasing,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e];this.animationNames.length=t.animationNames.length;for(var e=0,i=this.animationNames.length;e<i;++e)this.animationNames[e]=t.animationNames[e]},e.prototype.containsBoneMask=function(t){return 0===this.boneMask.length||this.boneMask.indexOf(t)>=0},e.prototype.addBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=t.getBone(e);if(a&&(this.boneMask.indexOf(e)<0&&this.boneMask.push(e),i))for(var r=t.getBones(),n=0,s=r.length;n<s;++n){var o=r[n];this.boneMask.indexOf(o.name)<0&&a.contains(o)&&this.boneMask.push(o.name)}},e.prototype.removeBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=this.boneMask.indexOf(e);if(a>=0&&this.boneMask.splice(a,1),i){var r=t.getBone(e);if(r){var n=t.getBones();if(this.boneMask.length>0)for(var s=0,o=n.length;s<o;++s){var l=n[s],h=this.boneMask.indexOf(l.name);h>=0&&r.contains(l)&&this.boneMask.splice(h,1)}else for(var s=0,o=n.length;s<o;++s){var l=n[s];r.contains(l)||this.boneMask.push(l.name)}}}},e}(t.BaseObject);t.AnimationConfig=e}(i||(i={}));var i;!function(t){var e=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype._onClear=function(){this.position=0,this.duration=0,this.prev=null,this.next=null},e}(t.BaseObject);t.FrameData=e;var i=function(e){function i(){return e.call(this)||this}return r(i,e),i._getCurvePoint=function(t,e,i,a,r,n,s,o,l,h){var u=1-l,_=u*u,f=l*l,c=u*_,m=3*l*_,p=3*u*f,d=l*f;h.x=c*t+m*i+p*r+d*s,h.y=c*e+m*a+p*n+d*o},i.samplingEasingCurve=function(e,a){for(var r=e.length,n=new t.Point,s=-2,o=0,l=a.length;o<l;++o){for(var h=(o+1)/(l+1);(s+6<r?e[s+6]:1)<h;)s+=6;for(var u=s>=0&&s+6<r,_=u?e[s]:0,f=u?e[s+1]:0,c=e[s+2],m=e[s+3],p=e[s+4],d=e[s+5],y=u?e[s+6]:1,g=u?e[s+7]:1,v=0,b=1;b-v>.01;){var T=(b+v)/2;i._getCurvePoint(_,f,c,m,p,d,y,g,T,n),h-n.x>0?v=T:b=T}a[o]=n.y}},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},i}(e);t.TweenFrameData=i;var a=function(t){function e(){var e=t.call(this)||this;return e.actions=[],e.events=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.AnimationFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions.length;e<i;++e)this.actions[e].returnToPool();for(var e=0,i=this.events.length;e<i;++e)this.events[e].returnToPool();this.actions.length=0,this.events.length=0},e}(e);t.AnimationFrameData=a;var n=function(t){function e(){var e=t.call(this)||this;return e.zOrder=[],e}return r(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.zOrder.length=0},e}(e);t.ZOrderFrameData=n;var s=function(e){function i(){var i=e.call(this)||this;return i.transform=new t.Transform,i}return r(i,e),i.toString=function(){return"[class dragonBones.BoneFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.transform.identity()},i}(i);t.BoneFrameData=s;var o=function(e){function i(){return e.call(this)||this}return r(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.displayIndex=0,this.color=null},i}(i);o.DEFAULT_COLOR=new t.ColorTransform,t.SlotFrameData=o;var l=function(t){function e(){var e=t.call(this)||this;return e.tweens=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.ExtensionFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.tweens.length=0},e}(i);t.ExtensionFrameData=l}(i||(i={}));var i;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.frames=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){for(var t=null,e=0,i=this.frames.length;e<i;++e){var a=this.frames[e];t&&a!==t&&t.returnToPool(),t=a}this.scale=1,this.offset=0,this.frames.length=0},e}(t.BaseObject);t.TimelineData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineData]"},e}(e);t.ZOrderTimelineData=i;var a=function(e){function i(){var i=e.call(this)||this;return i.originalTransform=new t.Transform,i}return r(i,e),i.toString=function(){return"[class dragonBones.BoneTimelineData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.originalTransform.identity(),this.bone=null},i}(e);t.BoneTimelineData=a;var n=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.SlotTimelineData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.slot=null},e}(e);t.SlotTimelineData=n;var s=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.FFDTimelineData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.skin=null,this.slot=null,this.display=null},e}(e);t.FFDTimelineData=s}(i||(i={}));var i;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.boneTimelines={},t.slotTimelines={},t.ffdTimelines={},t.cachedFrames=[],t.boneCachedFrameIndices={},t.slotCachedFrameIndices={},t}return r(i,e),i.toString=function(){return"[class dragonBones.AnimationData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var t in this.boneTimelines)this.boneTimelines[t].returnToPool(),delete this.boneTimelines[t];for(var t in this.slotTimelines)this.slotTimelines[t].returnToPool(),delete this.slotTimelines[t];for(var t in this.ffdTimelines){for(var i in this.ffdTimelines[t])for(var a in this.ffdTimelines[t][i])this.ffdTimelines[t][i][a].returnToPool();delete this.ffdTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameCount=0,this.playTimes=0,this.duration=0,this.fadeInTime=0,this.cacheFrameRate=0,this.name=null,this.cachedFrames.length=0,this.zOrderTimeline=null},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=0,this.cachedFrames.length=e;for(var i in this.boneTimelines){for(var a=new Array(e),r=0,n=a.length;r<n;++r)a[r]=-1;this.boneCachedFrameIndices[i]=a}for(var i in this.slotTimelines){for(var a=new Array(e),r=0,n=a.length;r<n;++r)a[r]=-1;this.slotCachedFrameIndices[i]=a}}},i.prototype.addBoneTimeline=function(e){if(!e||!e.bone||this.boneTimelines[e.bone.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.boneTimelines[e.bone.name]=e},i.prototype.addSlotTimeline=function(e){if(!e||!e.slot||this.slotTimelines[e.slot.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slotTimelines[e.slot.name]=e},i.prototype.addFFDTimeline=function(e){if(!(e&&e.skin&&e.slot&&e.display))throw new Error(t.DragonBones.ARGUMENT_ERROR);var i=this.ffdTimelines[e.skin.name]=this.ffdTimelines[e.skin.name]||{},a=i[e.slot.slot.name]=i[e.slot.slot.name]||{};if(a[e.display.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);a[e.display.name]=e},i.prototype.getBoneTimeline=function(t){return this.boneTimelines[t]},i.prototype.getSlotTimeline=function(t){return this.slotTimelines[t]},i.prototype.getFFDTimeline=function(t,e){var i=this.ffdTimelines[t];return i?i[e]:null},i.prototype.getBoneCachedFrameIndices=function(t){return this.boneCachedFrameIndices[t]},i.prototype.getSlotCachedFrameIndices=function(t){return this.slotCachedFrameIndices[t]},i}(t.TimelineData);t.AnimationData=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.aabb=new t.Rectangle,i.bones={},i.slots={},i.skins={},i.animations={},i.actions=[],i._animationNames=[],i._sortedBones=[],i._sortedSlots=[],i._bonesChildren={},i}return r(i,e),i.toString=function(){return"[class dragonBones.ArmatureData]"},i._onSortSlots=function(t,e){return t.zOrder>e.zOrder?1:-1},i.prototype._onClear=function(){for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];for(var e=0,i=this.actions.length;e<i;++e)this.actions[e].returnToPool();for(var t in this._bonesChildren)delete this._bonesChildren[t];this.userData&&this.userData.returnToPool(),this.isRightTransform=!1,this.frameRate=0,this.type=-1,this.cacheFrameRate=0,this.scale=1,this.name=null,this.aabb.clear(),this.actions.length=0,this.parent=null,this.userData=null,this._boneDirty=!1,this._slotDirty=!1,this._animationNames.length=0,this._sortedBones.length=0,this._sortedSlots.length=0,this._defaultSkin=null,this._defaultAnimation=null},i.prototype._sortBones=function(){var t=this._sortedBones.length;if(!(t<1)){var e=this._sortedBones.concat(),i=0,a=0;for(this._sortedBones.length=0;a<t;){var r=e[i++];i>=t&&(i=0),this._sortedBones.indexOf(r)>=0||r.parent&&this._sortedBones.indexOf(r.parent)<0||r.ik&&this._sortedBones.indexOf(r.ik)<0||(r.ik&&r.chain>0&&r.chainIndex===r.chain?this._sortedBones.splice(this._sortedBones.indexOf(r.parent)+1,0,r):this._sortedBones.push(r),a++)}}},i.prototype._sortSlots=function(){this._sortedSlots.sort(i._onSortSlots)},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=t;for(var e in this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)}},i.prototype.setCacheFrame=function(t,e,i){void 0===i&&(i=-1);var a=this.parent.cachedFrames;return i<0&&(i=a.length),a.length+=10,a[i]=t.a,a[i+1]=t.b,a[i+2]=t.c,a[i+3]=t.d,a[i+4]=t.tx,a[i+5]=t.ty,a[i+6]=e.skewX,a[i+7]=e.skewY,a[i+8]=e.scaleX,a[i+9]=e.scaleY,i},i.prototype.getCacheFrame=function(t,e,i){var a=this.parent.cachedFrames;t.a=a[i],t.b=a[i+1],t.c=a[i+2],t.d=a[i+3],t.tx=a[i+4],t.ty=a[i+5],e.skewX=a[i+6],e.skewY=a[i+7],e.scaleX=a[i+8],e.scaleY=a[i+9],e.x=t.tx,e.y=t.ty},i.prototype.addBone=function(e,i){if(!e||!e.name||this.bones[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);if(i){var a=this.getBone(i);a?e.parent=a:(this._bonesChildren[i]=this._bonesChildren[i]||[]).push(e)}var r=this._bonesChildren[e.name];if(r){for(var n=0,s=r.length;n<s;++n)r[n].parent=e;delete this._bonesChildren[e.name]}this.bones[e.name]=e,this._sortedBones.push(e),this._boneDirty=!0},i.prototype.addSlot=function(e){if(!e||!e.name||this.slots[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slots[e.name]=e,this._sortedSlots.push(e),this._slotDirty=!0},i.prototype.addSkin=function(e){if(!e||!e.name||this.skins[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.skins[e.name]=e,this._defaultSkin||(this._defaultSkin=e)},i.prototype.addAnimation=function(e){if(!e||!e.name||this.animations[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.animations[e.name]=e,this._animationNames.push(e.name),this._defaultAnimation||(this._defaultAnimation=e)},i.prototype.getBone=function(t){return this.bones[t]},i.prototype.getSlot=function(t){return this.slots[t]},i.prototype.getSkin=function(t){return t?this.skins[t]:this._defaultSkin},i.prototype.getAnimation=function(t){return t?this.animations[t]:this._defaultAnimation},Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedBones",{get:function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedSlots",{get:function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultSkin",{get:function(){return this._defaultSkin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultAnimation",{get:function(){return this._defaultAnimation},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.ArmatureData=e;var i=function(e){function i(){var i=e.call(this)||this;return i.transform=new t.Transform,i}return r(i,e),i.toString=function(){return"[class dragonBones.BoneData]"},i.prototype._onClear=function(){this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.transform.identity(),this.parent=null,this.ik=null,this.userData=null},i}(t.BaseObject);t.BoneData=i;var a=function(e){function i(){var t=e.call(this)||this;return t.actions=[],t}return r(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotData]"},i.prototype._onClear=function(){for(var t=0,e=this.actions.length;t<e;++t)this.actions[t].returnToPool();this.userData&&this.userData.returnToPool(),this.displayIndex=-1,this.zOrder=0,this.blendMode=-1,this.name=null,this.actions.length=0,this.parent=null,this.color=null,this.userData=null},i}(t.BaseObject);a.DEFAULT_COLOR=new t.ColorTransform,t.SlotData=a;var n=function(e){function i(){var t=e.call(this)||this;return t.slots={},t}return r(i,e),i.toString=function(){return"[class dragonBones.SkinData]"},i.prototype._onClear=function(){for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];this.name=null},i.prototype.addSlot=function(e){if(!e||!e.slot||this.slots[e.slot.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slots[e.slot.name]=e},i.prototype.getSlot=function(t){return this.slots[t]},i}(t.BaseObject);t.SkinData=n;var s=function(e){function i(){var t=e.call(this)||this;return t.displays=[],t.meshs={},t}return r(i,e),i.toString=function(){return"[class dragonBones.SkinSlotData]"},i.prototype._onClear=function(){for(var t=0,e=this.displays.length;t<e;++t)this.displays[t].returnToPool();for(var i in this.meshs)this.meshs[i].returnToPool(),delete this.meshs[i];this.displays.length=0,this.slot=null},i.prototype.getDisplay=function(t){for(var e=0,i=this.displays.length;e<i;++e){var a=this.displays[e];if(a.name===t)return a}return null},i.prototype.addMesh=function(e){if(!e||!e.name||this.meshs[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.meshs[e.name]=e},i.prototype.getMesh=function(t){return this.meshs[t]},i}(t.BaseObject);t.SkinSlotData=s;var o=function(e){function i(){var i=e.call(this)||this;return i.pivot=new t.Point,i.transform=new t.Transform,i}return r(i,e),i.toString=function(){return"[class dragonBones.DisplayData]"},i.prototype._onClear=function(){this.boundingBox&&this.boundingBox.returnToPool(),this.isRelativePivot=!1,this.type=-1,this.inheritAnimation=!0,this.name=null,this.path=null,this.share=null,this.pivot.clear(),this.transform.identity(),this.texture=null,this.armature=null,this.mesh=null,this.boundingBox=null},i}(t.BaseObject);t.DisplayData=o;var l=function(e){function i(){var i=e.call(this)||this;return i.slotPose=new t.Matrix,i.uvs=[],i.vertices=[],i.vertexIndices=[],i.boneIndices=[],i.weights=[],i.boneVertices=[],i.bones=[],i.inverseBindPose=[],i}return r(i,e),i.toString=function(){return"[class dragonBones.MeshData]"},i.prototype._onClear=function(){this.skinned=!1,this.name=null,this.slotPose.identity(),this.uvs.length=0,this.vertices.length=0,this.vertexIndices.length=0,this.boneIndices.length=0,this.weights.length=0,this.boneVertices.length=0,this.bones.length=0,this.inverseBindPose.length=0},i}(t.BaseObject);t.MeshData=l;var h=function(t){function e(){var e=t.call(this)||this;return e.vertices=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.BoundingBoxData]"},e._computeOutCode=function(t,e,i,a,r,n){var s=0;return t<i?s|=1:t>r&&(s|=2),e<a?s|=4:e>n&&(s|=8),s},e.segmentIntersectsRectangle=function(t,i,a,r,n,s,o,l,h,u,_){void 0===h&&(h=null),void 0===u&&(u=null),void 0===_&&(_=null);var f=t>n&&t<o&&i>s&&i<l,c=a>n&&a<o&&r>s&&r<l;if(f&&c)return-1;for(var m=0,p=e._computeOutCode(t,i,n,s,o,l),d=e._computeOutCode(a,r,n,s,o,l);;){if(!(p|d)){m=2;break}if(p&d)break;var y=0,g=0,v=0,b=p?p:d;4&b?(y=t+(a-t)*(s-i)/(r-i),g=s,_&&(v=.5*-Math.PI)):8&b?(y=t+(a-t)*(l-i)/(r-i),g=l,_&&(v=.5*Math.PI)):2&b?(g=i+(r-i)*(o-t)/(a-t),y=o,_&&(v=0)):1&b&&(g=i+(r-i)*(n-t)/(a-t),y=n,_&&(v=Math.PI)),b===p?(t=y,i=g,p=e._computeOutCode(t,i,n,s,o,l),_&&(_.x=v)):(a=y,r=g,d=e._computeOutCode(a,r,n,s,o,l),_&&(_.y=v))}return m&&(f?(m=2,h&&(h.x=a,h.y=r),u&&(u.x=a,u.y=a),_&&(_.x=_.y+Math.PI)):c?(m=1,h&&(h.x=t,h.y=i),u&&(u.x=t,u.y=i),_&&(_.y=_.x+Math.PI)):(m=3,h&&(h.x=t,h.y=i),u&&(u.x=a,u.y=r))),m},e.segmentIntersectsEllipse=function(t,e,i,a,r,n,s,o,l,h,u){void 0===l&&(l=null),void 0===h&&(h=null),void 0===u&&(u=null);var _=s/o,f=_*_;e*=_,a*=_;var c=i-t,m=a-e,p=Math.sqrt(c*c+m*m),d=c/p,y=m/p,g=(r-t)*d+(n-e)*y,v=g*g,b=t*t+e*e,T=s*s,D=T-b+v,O=0;if(D>=0){var x=Math.sqrt(D),S=g-x,w=g+x,E=S<0?-1:S<=p?0:1,A=w<0?-1:w<=p?0:1,M=E*A;if(M<0)return-1;0===M&&(E===-1?(O=2,i=t+w*d,a=(e+w*y)/_,l&&(l.x=i,l.y=a),h&&(h.x=i,h.y=a),u&&(u.x=Math.atan2(a/T*f,i/T),u.y=u.x+Math.PI)):1===A?(O=1,t+=S*d,e=(e+S*y)/_,l&&(l.x=t,l.y=e),h&&(h.x=t,h.y=e),u&&(u.x=Math.atan2(e/T*f,t/T),u.y=u.x+Math.PI)):(O=3,l&&(l.x=t+S*d,l.y=(e+S*y)/_,u&&(u.x=Math.atan2(l.y/T*f,l.x/T))),h&&(h.x=t+w*d,h.y=(e+w*y)/_,u&&(u.y=Math.atan2(h.y/T*f,h.x/T)))))}return O},e.segmentIntersectsPolygon=function(t,e,i,a,r,n,s,o){void 0===n&&(n=null),void 0===s&&(s=null),void 0===o&&(o=null),t===i&&(t=i+.01),e===a&&(e=a+.01);for(var l=r.length,h=t-i,u=e-a,_=t*a-e*i,f=0,c=r[l-2],m=r[l-1],p=0,d=0,y=0,g=0,v=0,b=0,T=0;T<l;T+=2){var D=r[T],O=r[T+1];c===D&&(c=D+.01),m===O&&(m=O+.01);var x=c-D,S=m-O,w=c*O-m*D,E=h*S-u*x,A=(_*x-h*w)/E;if((A>=c&&A<=D||A>=D&&A<=c)&&(0===h||A>=t&&A<=i||A>=i&&A<=t)){var M=(_*S-u*w)/E;if((M>=m&&M<=O||M>=O&&M<=m)&&(0===u||M>=e&&M<=a||M>=a&&M<=e)){if(!s){y=A,g=M,v=A,b=M,f++,o&&(o.x=Math.atan2(O-m,D-c)-.5*Math.PI,o.y=o.x);break}var P=A-t;P<0&&(P=-P),0===f?(p=P,d=P,y=A,g=M,v=A,b=M,o&&(o.x=Math.atan2(O-m,D-c)-.5*Math.PI,o.y=o.x)):(P<p&&(p=P,y=A,g=M,o&&(o.x=Math.atan2(O-m,D-c)-.5*Math.PI)),P>d&&(d=P,v=A,b=M,o&&(o.y=Math.atan2(O-m,D-c)-.5*Math.PI))),f++}}c=D,m=O}return 1===f?(n&&(n.x=y,n.y=g),s&&(s.x=y,s.y=g),o&&(o.y=o.x+Math.PI)):f>1&&(f++,n&&(n.x=y,n.y=g),s&&(s.x=v,s.y=b)),f},e.prototype._onClear=function(){this.type=-1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0,this.vertices.length=0},e.prototype.containsPoint=function(t,e){var i=!1;if(2===this.type){if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var a=0,r=this.vertices.length,n=r-2;a<r;a+=2){var s=this.vertices[n+1],o=this.vertices[a+1];if(o<e&&s>=e||s<e&&o>=e){var l=this.vertices[n],h=this.vertices[a];(e-o)*(l-h)/(s-o)+h<t&&(i=!i)}n=a}}else{var u=.5*this.width;if(t>=-u&&t<=u){var _=.5*this.height;e>=-_&&e<=_&&(1===this.type?(e*=u/_,i=Math.sqrt(t*t+e*e)<=u):i=!0)}}return i},e.prototype.intersectsSegment=function(t,i,a,r,n,s,o){void 0===n&&(n=null),void 0===s&&(s=null),void 0===o&&(o=null);var l=0;switch(this.type){case 0:var h=.5*this.width,u=.5*this.height;l=e.segmentIntersectsRectangle(t,i,a,r,-h,-u,h,u,n,s,o);break;case 1:l=e.segmentIntersectsEllipse(t,i,a,r,0,0,.5*this.width,.5*this.height,n,s,o);break;case 2:0!==e.segmentIntersectsRectangle(t,i,a,r,this.x,this.y,this.width,this.height,null,null)&&(l=e.segmentIntersectsPolygon(t,i,a,r,this.vertices,n,s,o))}return l},e}(t.BaseObject);t.BoundingBoxData=h}(i||(i={}));var i;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.ints=[],e.floats=[],e.strings=[],e}return r(e,t),e.toString=function(){return"[class dragonBones.CustomData]"},e.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},e.prototype.getInt=function(t){return void 0===t&&(t=0),t>=0&&t<this.ints.length?this.ints[t]:0},e.prototype.getFloat=function(t){return void 0===t&&(t=0),t>=0&&t<this.floats.length?this.floats[t]:0},e.prototype.getString=function(t){return void 0===t&&(t=0),t>=0&&t<this.strings.length?this.strings[t]:null},e}(t.BaseObject);t.CustomData=e;var i=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.EventData]"},e.prototype._onClear=function(){this.data&&this.data.returnToPool(),this.type=-1,this.name=null,this.bone=null,this.slot=null,this.data=null},e}(t.BaseObject);t.EventData=i;var a=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.ActionData]"},e.prototype._onClear=function(){this.animationConfig&&this.animationConfig.returnToPool(),this.type=-1,this.bone=null,this.slot=null,this.animationConfig=null},e}(t.BaseObject);t.ActionData=a;var n=function(e){function i(){var t=e.call(this)||this;return t.armatures={},t.cachedFrames=[],t._armatureNames=[],t}return r(i,e),i.toString=function(){return"[class dragonBones.DragonBonesData]"},i.prototype._onClear=function(){
if(t.DragonBones.debug)for(var e=0,i=t.DragonBones._armatures.length;e<i;++e){var a=t.DragonBones._armatures[e];if(a.armatureData.parent===this)throw new Error("The DragonBonesData is being used, please make sure all armature references to the data have been deleted.")}for(var r in this.armatures)this.armatures[r].returnToPool(),delete this.armatures[r];this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version=null,this.name=null,this.cachedFrames.length=0,this.userData=null,this._armatureNames.length=0},i.prototype.addArmature=function(e){if(!e||!e.name||this.armatures[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.armatures[e.name]=e,this._armatureNames.push(e.name),e.parent=this},i.prototype.getArmature=function(t){return this.armatures[t]},Object.defineProperty(i.prototype,"armatureNames",{get:function(){return this._armatureNames},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.returnToPool()},i}(t.BaseObject);t.DragonBonesData=n}(i||(i={}));var i;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.textures={},t}return r(i,e),i.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.scale=1,this.width=0,this.height=0,this.name=null,this.imagePath=null},i.prototype.addTexture=function(e){if(!e||!e.name||this.textures[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.textures[e.name]=e,e.parent=this},i.prototype.getTexture=function(t){return this.textures[t]},i.prototype.copyFrom=function(t){this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath;for(var e in this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.generateTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},i}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function i(){var i=e.call(this)||this;return i.region=new t.Rectangle,i}return r(i,e),i.generateRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name=null,this.region.clear(),this.frame=null,this.parent=null},i.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,!this.frame&&t.frame?this.frame=i.generateRectangle():this.frame&&!t.frame&&(this.frame=null),this.frame&&t.frame&&this.frame.copyFrom(t.frame),this.parent=t.parent,this.region.copyFrom(t.region)},i}(t.BaseObject);t.TextureData=i}(i||(i={}));var i;!function(t){var e=function(){function e(){this._isOldData=!1,this._isGlobalTransform=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._timelinePivot=new t.Point,this._helpPoint=new t.Point,this._helpTransformA=new t.Transform,this._helpTransformB=new t.Transform,this._helpMatrix=new t.Matrix,this._rawBones=[],this._data=null,this._armature=null,this._skin=null,this._skinSlotData=null,this._animation=null,this._timeline=null}return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return-1}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;default:return-1}},e._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return-1}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return-1}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":case"gotoandplay":return 0;default:return-1}},e.prototype._getTimelineFrameMatrix=function(e,i,a,r){var n=Math.floor(a*e.frameCount/e.duration);if(1===i.frames.length||n>=i.frames.length)r.copyFrom(i.frames[0].transform);else{var s=i.frames[n],o=0;s.tweenEasing!==t.DragonBones.NO_TWEEN?(o=(a-s.position)/s.duration,0!==s.tweenEasing&&(o=t.TweenTimelineState._getEasingValue(o,s.tweenEasing))):s.curve&&(o=(a-s.position)/s.duration,o=t.TweenTimelineState._getEasingCurveValue(o,s.curve));var l=s.next;r.x=l.transform.x-s.transform.x,r.y=l.transform.y-s.transform.y,r.skewX=t.Transform.normalizeRadian(l.transform.skewX-s.transform.skewX),r.skewY=t.Transform.normalizeRadian(l.transform.skewY-s.transform.skewY),r.scaleX=l.transform.scaleX-s.transform.scaleX,r.scaleY=l.transform.scaleY-s.transform.scaleY,r.x=s.transform.x+r.x*o,r.y=s.transform.y+r.y*o,r.skewX=s.transform.skewX+r.skewX*o,r.skewY=s.transform.skewY+r.skewY*o,r.scaleX=s.transform.scaleX+r.scaleX*o,r.scaleY=s.transform.scaleY+r.scaleY*o}r.add(i.originalTransform)},e.prototype._globalToLocal=function(t){for(var e=new Array,i=t.sortedBones.concat().reverse(),a=0,r=i.length;a<r;++a){var n=i[a];n.parent&&(n.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(n.transform.x,n.transform.y,this._helpPoint),n.transform.x=this._helpPoint.x,n.transform.y=this._helpPoint.y,n.transform.rotation-=n.parent.transform.rotation);for(var s in t.animations){var o=t.animations[s],l=o.getBoneTimeline(n.name);if(l){var h=n.parent?o.getBoneTimeline(n.parent.name):null;this._helpTransformB.copyFrom(l.originalTransform),e.length=0;for(var u=0,_=l.frames.length;u<_;++u){var f=l.frames[u];e.indexOf(f)>=0||(e.push(f),h?(this._getTimelineFrameMatrix(o,h,f.position,this._helpTransformA),f.transform.add(this._helpTransformB),this._helpTransformA.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(f.transform.x,f.transform.y,this._helpPoint),f.transform.x=this._helpPoint.x,f.transform.y=this._helpPoint.y,f.transform.rotation-=this._helpTransformA.rotation):f.transform.add(this._helpTransformB),f.transform.minus(n.transform),0===u?(l.originalTransform.copyFrom(f.transform),f.transform.identity()):f.transform.minus(l.originalTransform))}}}}},e.prototype._mergeFrameToAnimationTimeline=function(e,i,a){var r=Math.floor(e*this._armature.frameRate),n=this._animation.frames;if(0===n.length){var s=t.BaseObject.borrowObject(t.AnimationFrameData);if(s.position=0,this._animation.frameCount>1){n.length=this._animation.frameCount+1;var o=t.BaseObject.borrowObject(t.AnimationFrameData);o.position=this._animation.frameCount/this._armature.frameRate,n[0]=s,n[this._animation.frameCount]=o}}var l=null,h=n[r];if(!h||0!==r&&n[r-1]!==h.prev){l=t.BaseObject.borrowObject(t.AnimationFrameData),l.position=r/this._armature.frameRate,n[r]=l;for(var u=r+1,_=n.length;u<_;++u)h&&n[u]===h&&(n[u]=null)}else l=h;if(i)for(var u=0,_=i.length;u<_;++u)l.actions.push(i[u]);if(a)for(var u=0,_=a.length;u<_;++u)l.events.push(a[u]);for(var f=null,c=null,u=0,_=n.length;u<_;++u){var m=n[u];m&&c!==m?(c=m,f&&(c.prev=f,f.next=c,f.duration=c.position-f.position),f=c):n[u]=f}c.duration=this._animation.duration-c.position,c=n[0],f.next=c,c.prev=f},e.parseDragonBonesData=function(e){return t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,a){void 0===a&&(a=1);for(var r={},n=i[e.SUB_TEXTURE],s=0,o=n.length;s<o;s++){var l=n[s],h=l[e.NAME],u=new t.Rectangle,_=null;u.x=l[e.X]/a,u.y=l[e.Y]/a,u.width=l[e.WIDTH]/a,u.height=l[e.HEIGHT]/a,e.FRAME_WIDTH in l&&(_=new t.Rectangle,_.x=l[e.FRAME_X]/a,_.y=l[e.FRAME_Y]/a,_.width=l[e.FRAME_WIDTH]/a,_.height=l[e.FRAME_HEIGHT]/a),r[h]={region:u,frame:_,rotated:!1}}return r},e}();e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION_4_5="4.5",e.DATA_VERSION_5_0="5.0",e.DATA_VERSION=e.DATA_VERSION_5_0,e.DATA_VERSIONS=[e.DATA_VERSION_5_0,e.DATA_VERSION_4_5,e.DATA_VERSION_4_0,e.DATA_VERSION_3_0,e.DATA_VERSION_2_3],e.TEXTURE_ATLAS="TextureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.ARMATURE="armature",e.BONE="bone",e.IK="ik",e.SLOT="slot",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.Z_ORDER="zOrder",e.FFD="ffd",e.FRAME="frame",e.ACTIONS="actions",e.EVENTS="events",e.INTS="ints",e.FLOATS="floats",e.STRINGS="strings",e.PIVOT="pivot",e.TRANSFORM="transform",e.AABB="aabb",e.COLOR="color",e.VERSION="version",e.COMPATIBLE_VERSION="compatibleVersion",e.FRAME_RATE="frameRate",e.TYPE="type",e.SUB_TYPE="subType",e.NAME="name",e.PARENT="parent",e.TARGET="target",e.SHARE="share",e.PATH="path",e.LENGTH="length",e.DISPLAY_INDEX="displayIndex",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.INHERIT_REFLECTION="inheritReflection",e.INHERIT_ANIMATION="inheritAnimation",e.INHERIT_FFD="inheritFFD",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_TYPE="tweenType",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CURVE="curve",e.EVENT="event",e.SOUND="sound",e.ACTION="action",e.DEFAULT_ACTIONS="defaultActions",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.COLOR_TRANSFORM="colorTransform",e.TIMELINE="timeline",e.IS_GLOBAL="isGlobal",e.PIVOT_X="pX",e.PIVOT_Y="pY",e.Z="z",e.LOOP="loop",e.AUTO_TWEEN="autoTween",e.HIDE="hide",e.DEFAULT_NAME="__default",t.DataParser=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){return e.call(this)||this}return r(i,e),i._getBoolean=function(t,e,i){if(e in t){var r=t[e],n="undefined"==typeof r?"undefined":a(r);if("boolean"===n)return r;if("string"!==n)return!!r;switch(r){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},i._getNumber=function(t,e,i){if(e in t){var a=t[e];return null==a||"NaN"===a?i:+a||0}return i},i._getString=function(t,e,i){return e in t?String(t[e]):i},i.prototype._parseArmature=function(e,a){var r=t.BaseObject.borrowObject(t.ArmatureData);if(r.isRightTransform=i.DATA_VERSIONS.indexOf(this._data.version)>i.DATA_VERSIONS.indexOf(i.DATA_VERSION_4_5),r.name=i._getString(e,i.NAME,null),r.frameRate=i._getNumber(e,i.FRAME_RATE,this._data.frameRate),r.scale=a,0===r.frameRate&&(r.frameRate=24),i.TYPE in e&&"string"==typeof e[i.TYPE]?r.type=i._getArmatureType(e[i.TYPE]):r.type=i._getNumber(e,i.TYPE,0),this._armature=r,this._rawBones.length=0,i.AABB in e){var n=e[i.AABB];r.aabb.x=i._getNumber(n,i.X,0),r.aabb.y=i._getNumber(n,i.Y,0),r.aabb.width=i._getNumber(n,i.WIDTH,0),r.aabb.height=i._getNumber(n,i.HEIGHT,0)}if(i.BONE in e)for(var s=e[i.BONE],o=0,l=s.length;o<l;++o){var h=s[o],u=this._parseBone(h);r.addBone(u,i._getString(h,i.PARENT,null)),this._rawBones.push(u)}if(i.IK in e)for(var _=e[i.IK],o=0,l=_.length;o<l;++o)this._parseIK(_[o]);if(i.SLOT in e)for(var f=e[i.SLOT],c=0,o=0,l=f.length;o<l;++o)r.addSlot(this._parseSlot(f[o],c++));if(i.SKIN in e)for(var m=e[i.SKIN],o=0,l=m.length;o<l;++o)r.addSkin(this._parseSkin(m[o]));if(i.ANIMATION in e)for(var p=e[i.ANIMATION],o=0,l=p.length;o<l;++o)r.addAnimation(this._parseAnimation(p[o]));return(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,r.actions,null,null),this._isOldData&&this._isGlobalTransform&&this._globalToLocal(r),this._armature=null,this._rawBones.length=0,r},i.prototype._parseBone=function(e){var a=t.BaseObject.borrowObject(t.BoneData);return a.inheritTranslation=i._getBoolean(e,i.INHERIT_TRANSLATION,!0),a.inheritRotation=i._getBoolean(e,i.INHERIT_ROTATION,!0),a.inheritScale=i._getBoolean(e,i.INHERIT_SCALE,!0),a.inheritReflection=i._getBoolean(e,i.INHERIT_REFLECTION,!0),a.length=i._getNumber(e,i.LENGTH,0)*this._armature.scale,a.name=i._getString(e,i.NAME,null),i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],a.transform),this._isOldData&&(a.inheritScale=!1),a},i.prototype._parseIK=function(t){var e=this._armature.getBone(i._getString(t,i.BONE in t?i.BONE:i.NAME,null));e&&(e.bendPositive=i._getBoolean(t,i.BEND_POSITIVE,!0),e.chain=i._getNumber(t,i.CHAIN,0),e.weight=i._getNumber(t,i.WEIGHT,1),e.ik=this._armature.getBone(i._getString(t,i.TARGET,null)),e.chain>0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.parent.weight=e.weight,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},i.prototype._parseSlot=function(e,a){var r=t.BaseObject.borrowObject(t.SlotData);return r.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),r.zOrder=i._getNumber(e,i.Z,a),r.name=i._getString(e,i.NAME,null),r.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),i.COLOR in e||i.COLOR_TRANSFORM in e?(r.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],r.color)):r.color=t.SlotData.DEFAULT_COLOR,i.BLEND_MODE in e&&"string"==typeof e[i.BLEND_MODE]?r.blendMode=i._getBlendMode(e[i.BLEND_MODE]):r.blendMode=i._getNumber(e,i.BLEND_MODE,0),(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,r.actions,null,null),r},i.prototype._parseSkin=function(e){var a=t.BaseObject.borrowObject(t.SkinData);if(a.name=i._getString(e,i.NAME,i.DEFAULT_NAME),a.name||(a.name=i.DEFAULT_NAME),i.SLOT in e){this._skin=a;for(var r=e[i.SLOT],n=0,s=0,o=r.length;s<o;++s)this._isOldData&&this._armature.addSlot(this._parseSlot(r[s],n++)),a.addSlot(this._parseSkinSlotData(r[s]));this._skin=null}return a},i.prototype._parseSkinSlotData=function(e){var a=t.BaseObject.borrowObject(t.SkinSlotData);if(a.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),i.DISPLAY in e){var r=e[i.DISPLAY];this._skinSlotData=a;for(var n=0,s=r.length;n<s;++n)a.displays.push(this._parseDisplay(r[n]));this._skinSlotData=null}return a},i.prototype._parseDisplay=function(e){var a=t.BaseObject.borrowObject(t.DisplayData);if(a.inheritAnimation=i._getBoolean(e,i.INHERIT_ANIMATION,!0),a.name=i._getString(e,i.NAME,null),a.path=i._getString(e,i.PATH,a.name),i.TYPE in e&&"string"==typeof e[i.TYPE]?a.type=i._getDisplayType(e[i.TYPE]):a.type=i._getNumber(e,i.TYPE,0),a.isRelativePivot=!0,i.PIVOT in e){var r=e[i.PIVOT];a.pivot.x=i._getNumber(r,i.X,0),a.pivot.y=i._getNumber(r,i.Y,0)}else if(this._isOldData){var n=e[i.TRANSFORM];a.isRelativePivot=!1,a.pivot.x=i._getNumber(n,i.PIVOT_X,0)*this._armature.scale,a.pivot.y=i._getNumber(n,i.PIVOT_Y,0)*this._armature.scale}else a.pivot.x=.5,a.pivot.y=.5;switch(i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],a.transform),a.type){case 0:break;case 1:break;case 2:a.share=i._getString(e,i.SHARE,null),a.share||(a.inheritAnimation=i._getBoolean(e,i.INHERIT_FFD,!0),a.mesh=this._parseMesh(e),this._skinSlotData.addMesh(a.mesh));break;case 3:a.boundingBox=this._parseBoundingBox(e)}return a},i.prototype._parseMesh=function(e){var a=t.BaseObject.borrowObject(t.MeshData),r=e[i.VERTICES],n=e[i.UVS],s=e[i.TRIANGLES],o=Math.floor(r.length/2),l=Math.floor(s.length/3),h=new Array(this._armature.sortedBones.length);if(a.skinned=i.WEIGHTS in e&&e[i.WEIGHTS].length>0,a.name=i._getString(e,i.NAME,null),a.uvs.length=2*o,a.vertices.length=2*o,a.vertexIndices.length=3*l,a.skinned){if(a.boneIndices.length=o,a.weights.length=o,a.boneVertices.length=o,i.SLOT_POSE in e){var u=e[i.SLOT_POSE];a.slotPose.a=u[0],a.slotPose.b=u[1],a.slotPose.c=u[2],a.slotPose.d=u[3],a.slotPose.tx=u[4]*this._armature.scale,a.slotPose.ty=u[5]*this._armature.scale}if(i.BONE_POSE in e)for(var _=e[i.BONE_POSE],f=0,c=_.length;f<c;f+=7){var m=_[f],p=h[m]=new t.Matrix;p.a=_[f+1],p.b=_[f+2],p.c=_[f+3],p.d=_[f+4],p.tx=_[f+5]*this._armature.scale,p.ty=_[f+6]*this._armature.scale,p.invert()}}for(var f=0,d=0,c=r.length;f<c;f+=2){var y=f+1,g=f/2,v=a.vertices[f]=r[f]*this._armature.scale,b=a.vertices[y]=r[y]*this._armature.scale;if(a.uvs[f]=n[f],a.uvs[y]=n[y],a.skinned){var T=e[i.WEIGHTS],D=T[d],O=a.boneIndices[g]=new Array(D),x=a.weights[g]=new Array(D),S=a.boneVertices[g]=new Array(2*D);a.slotPose.transformPoint(v,b,this._helpPoint),v=a.vertices[f]=this._helpPoint.x,b=a.vertices[y]=this._helpPoint.y;for(var w=0;w<D;++w){var E=d+1+2*w,m=T[E],A=this._rawBones[m],M=a.bones.indexOf(A);M<0&&(M=a.bones.length,a.bones[M]=A,a.inverseBindPose[M]=h[m]),a.inverseBindPose[M].transformPoint(v,b,this._helpPoint),O[w]=M,x[w]=T[E+1],S[2*w]=this._helpPoint.x,S[2*w+1]=this._helpPoint.y}d+=2*D+1}}for(var f=0,c=s.length;f<c;++f)a.vertexIndices[f]=s[f];return a},i.prototype._parseBoundingBox=function(e){var a=t.BaseObject.borrowObject(t.BoundingBoxData);switch(i.SUB_TYPE in e&&"string"==typeof e[i.SUB_TYPE]?a.type=i._getBoundingBoxType(e[i.SUB_TYPE]):a.type=i._getNumber(e,i.SUB_TYPE,0),a.color=i._getNumber(e,i.COLOR,0),a.type){case 0:case 1:a.width=i._getNumber(e,i.WIDTH,0),a.height=i._getNumber(e,i.HEIGHT,0);break;case 2:if(i.VERTICES in e){var r=e[i.VERTICES];a.vertices.length=r.length;for(var n=0,s=a.vertices.length;n<s;n+=2){var o=n+1,l=r[n],h=r[o];a.vertices[n]=l,a.vertices[o]=h,0===n?(a.x=l,a.y=h,a.width=l,a.height=h):(l<a.x?a.x=l:l>a.width&&(a.width=l),h<a.y?a.y=h:h>a.height&&(a.height=h))}}}return a},i.prototype._parseAnimation=function(e){var a=t.BaseObject.borrowObject(t.AnimationData);if(a.frameCount=Math.max(i._getNumber(e,i.DURATION,1),1),a.playTimes=i._getNumber(e,i.PLAY_TIMES,1),a.duration=a.frameCount/this._armature.frameRate,a.fadeInTime=i._getNumber(e,i.FADE_IN_TIME,0),a.name=i._getString(e,i.NAME,i.DEFAULT_NAME),a.name||(a.name=i.DEFAULT_NAME),this._animation=a,this._parseTimeline(e,a,this._parseAnimationFrame),i.Z_ORDER in e&&(a.zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineData),this._parseTimeline(e[i.Z_ORDER],a.zOrderTimeline,this._parseZOrderFrame)),i.BONE in e)for(var r=e[i.BONE],n=0,s=r.length;n<s;++n)a.addBoneTimeline(this._parseBoneTimeline(r[n]));if(i.SLOT in e)for(var o=e[i.SLOT],n=0,s=o.length;n<s;++n)a.addSlotTimeline(this._parseSlotTimeline(o[n]));if(i.FFD in e)for(var l=e[i.FFD],n=0,s=l.length;n<s;++n)a.addFFDTimeline(this._parseFFDTimeline(l[n]));if(this._isOldData){if(this._isAutoTween=i._getBoolean(e,i.AUTO_TWEEN,!0),this._animationTweenEasing=i._getNumber(e,i.TWEEN_EASING,0)||0,a.playTimes=i._getNumber(e,i.LOOP,1),i.TIMELINE in e)for(var h=e[i.TIMELINE],n=0,s=h.length;n<s;++n){var u=h[n];a.addBoneTimeline(this._parseBoneTimeline(u)),a.addSlotTimeline(this._parseSlotTimeline(u))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var n in this._armature.bones){var _=this._armature.bones[n];if(!a.getBoneTimeline(_.name)){var f=t.BaseObject.borrowObject(t.BoneTimelineData),c=t.BaseObject.borrowObject(t.BoneFrameData);f.bone=_,f.frames[0]=c,a.addBoneTimeline(f)}}for(var n in this._armature.slots){var m=this._armature.slots[n];if(!a.getSlotTimeline(m.name)){var p=t.BaseObject.borrowObject(t.SlotTimelineData),d=t.BaseObject.borrowObject(t.SlotFrameData);p.slot=m,d.displayIndex=m.displayIndex,m.color===t.SlotData.DEFAULT_COLOR?d.color=t.SlotFrameData.DEFAULT_COLOR:(d.color=t.SlotFrameData.generateColor(),d.color.copyFrom(m.color)),p.frames[0]=d,a.addSlotTimeline(p),this._isOldData&&(d.displayIndex=-1)}}return this._animation=null,a},i.prototype._parseBoneTimeline=function(e){var a=t.BaseObject.borrowObject(t.BoneTimelineData);a.bone=this._armature.getBone(i._getString(e,i.NAME,null)),this._parseTimeline(e,a,this._parseBoneFrame);for(var r=a.originalTransform,n=null,s=0,o=a.frames.length;s<o;++s){var l=a.frames[s];n?n!==l&&l.transform.minus(r):(r.copyFrom(l.transform),l.transform.identity(),0===r.scaleX&&(r.scaleX=.001),0===r.scaleY&&(r.scaleY=.001)),n=l}return this._isOldData&&(i.PIVOT_X in e||i.PIVOT_Y in e)?(this._timelinePivot.x=i._getNumber(e,i.PIVOT_X,0)*this._armature.scale,this._timelinePivot.y=i._getNumber(e,i.PIVOT_Y,0)*this._armature.scale):this._timelinePivot.clear(),a},i.prototype._parseSlotTimeline=function(e){var a=t.BaseObject.borrowObject(t.SlotTimelineData);return a.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),this._parseTimeline(e,a,this._parseSlotFrame),a},i.prototype._parseFFDTimeline=function(e){var a=t.BaseObject.borrowObject(t.FFDTimelineData);a.skin=this._armature.getSkin(i._getString(e,i.SKIN,null)),a.slot=a.skin.getSlot(i._getString(e,i.SLOT,null));for(var r=i._getString(e,i.NAME,null),n=0,s=a.slot.displays.length;n<s;++n){var o=a.slot.displays[n];if(o.mesh&&o.name===r){a.display=o;break}}return this._parseTimeline(e,a,this._parseFFDFrame),a},i.prototype._parseAnimationFrame=function(e,a,r){var n=t.BaseObject.borrowObject(t.AnimationFrameData);return this._parseFrame(e,n,a,r),(i.ACTION in e||i.ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),(i.EVENTS in e||i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,n.events,null,null),n},i.prototype._parseZOrderFrame=function(e,a,r){var n=t.BaseObject.borrowObject(t.ZOrderFrameData);this._parseFrame(e,n,a,r);var s=e[i.Z_ORDER];if(s&&s.length>0){var o=this._armature.sortedSlots.length,l=new Array(o-s.length/2);n.zOrder.length=o;for(var h=0;h<o;++h)n.zOrder[h]=-1;for(var u=0,_=0,f=0,c=s.length;f<c;f+=2){for(var m=s[f],p=s[f+1];u!==m;)l[_++]=u++;n.zOrder[u+p]=u++}for(;u<o;)l[_++]=u++;for(var d=o;d--;)n.zOrder[d]===-1&&(n.zOrder[d]=l[--_])}return n},i.prototype._parseBoneFrame=function(e,a,r){var n=t.BaseObject.borrowObject(t.BoneFrameData);if(n.tweenRotate=i._getNumber(e,i.TWEEN_ROTATE,0),n.tweenScale=i._getBoolean(e,i.TWEEN_SCALE,!0),this._parseTweenFrame(e,n,a,r),i.TRANSFORM in e){var s=e[i.TRANSFORM];this._parseTransform(s,n.transform),this._isOldData&&(this._helpPoint.x=this._timelinePivot.x+i._getNumber(s,i.PIVOT_X,0)*this._armature.scale,this._helpPoint.y=this._timelinePivot.y+i._getNumber(s,i.PIVOT_Y,0)*this._armature.scale,n.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),n.transform.x+=this._helpPoint.x,n.transform.y+=this._helpPoint.y)}var o=this._timeline.bone,l=new Array,h=new Array;if(i.ACTION in e||i.ACTIONS in e){var u=this._armature.getSlot(o.name);this._parseActionData(e,l,o,u)}return(i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,h,o,null),(l.length>0||h.length>0)&&this._mergeFrameToAnimationTimeline(n.position,l,h),n},i.prototype._parseSlotFrame=function(e,a,r){var n=t.BaseObject.borrowObject(t.SlotFrameData);if(n.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),this._parseTweenFrame(e,n,a,r),i.COLOR in e||i.COLOR_TRANSFORM in e?(n.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotFrameData.DEFAULT_COLOR,this._isOldData)i._getBoolean(e,i.HIDE,!1)&&(n.displayIndex=-1);else if(i.ACTION in e||i.ACTIONS in e){var s=this._timeline.slot,o=new Array;this._parseActionData(e,o,s.parent,s),this._mergeFrameToAnimationTimeline(n.position,o,null)}return n},i.prototype._parseFFDFrame=function(e,a,r){var n=this._timeline,s=n.display.mesh,o=t.BaseObject.borrowObject(t.ExtensionFrameData);this._parseTweenFrame(e,o,a,r);for(var l=e[i.VERTICES],h=i._getNumber(e,i.OFFSET,0),u=0,_=0,f=0,c=s.vertices.length;f<c;f+=2)if(l?(u=f<h||f-h>=l.length?0:l[f-h]*this._armature.scale,_=f+1<h||f+1-h>=l.length?0:l[f+1-h]*this._armature.scale):(u=0,_=0),s.skinned){s.slotPose.transformPoint(u,_,this._helpPoint,!0),u=this._helpPoint.x,_=this._helpPoint.y;for(var m=s.boneIndices[f/2],p=0,d=m.length;p<d;++p){var y=m[p];s.inverseBindPose[y].transformPoint(u,_,this._helpPoint,!0),o.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else o.tweens.push(u,_);return o},i.prototype._parseTweenFrame=function(e,a,r,n){this._parseFrame(e,a,r,n),a.duration>0?(i.TWEEN_EASING in e?a.tweenEasing=i._getNumber(e,i.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isOldData?a.tweenEasing=this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN:a.tweenEasing=t.DragonBones.NO_TWEEN,this._isOldData&&1===this._animation.scale&&1===this._timeline.scale&&a.duration*this._armature.frameRate<2&&(a.tweenEasing=t.DragonBones.NO_TWEEN),n>0&&i.CURVE in e&&(a.curve=new Array(2*n-1),t.TweenFrameData.samplingEasingCurve(e[i.CURVE],a.curve))):(a.tweenEasing=t.DragonBones.NO_TWEEN,a.curve=null)},i.prototype._parseFrame=function(t,e,i,a){e.position=i/this._armature.frameRate,e.duration=a/this._armature.frameRate},i.prototype._parseTimeline=function(e,a,r){if(a.scale=i._getNumber(e,i.SCALE,1),a.offset=i._getNumber(e,i.OFFSET,0),this._timeline=a,i.FRAME in e){var n=e[i.FRAME];if(1===n.length)a.frames.length=1,a.frames[0]=r.call(this,n[0],0,i._getNumber(n[0],i.DURATION,1));else if(n.length>1){a.frames.length=this._animation.frameCount+1;for(var s=0,o=0,l=null,h=null,u=0,_=0,f=a.frames.length;u<f;++u){if(s+o<=u&&_<n.length){var c=n[_++];s=u,o=i._getNumber(c,i.DURATION,1),l=r.call(this,c,s,o),h&&(h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&i._getNumber(c,i.DISPLAY_INDEX,0)===-1&&(h.tweenEasing=t.DragonBones.NO_TWEEN)),h=l}a.frames[u]=l}l.duration=this._animation.duration-l.position,l=a.frames[0],h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&i._getNumber(n[0],i.DISPLAY_INDEX,0)===-1&&(h.tweenEasing=t.DragonBones.NO_TWEEN)}}this._timeline=null},i.prototype._parseActionData=function(e,a,r,n){var s=e[i.ACTION]||e[i.ACTIONS]||e[i.DEFAULT_ACTIONS];if("string"==typeof s){var o=t.BaseObject.borrowObject(t.ActionData);o.type=0,o.bone=r,o.slot=n,o.animationConfig=t.BaseObject.borrowObject(t.AnimationConfig),o.animationConfig.animation=s,a.push(o)}else if(s instanceof Array)for(var l=0,h=s.length;l<h;++l){var u=s[l],_=u instanceof Array,o=t.BaseObject.borrowObject(t.ActionData),f=_?u[1]:i._getString(u,"gotoAndPlay",null);if(_){var c=u[0];"string"==typeof c?o.type=i._getActionType(c):o.type=c}else o.type=0;switch(o.type){case 0:o.animationConfig=t.BaseObject.borrowObject(t.AnimationConfig),o.animationConfig.animation=f}o.bone=r,o.slot=n,a.push(o)}},i.prototype._parseEventData=function(e,a,r,n){if(i.SOUND in e){var s=t.BaseObject.borrowObject(t.EventData);s.type=11,s.name=i._getString(e,i.SOUND,null),s.bone=r,s.slot=n,a.push(s)}if(i.EVENT in e){var o=t.BaseObject.borrowObject(t.EventData);o.type=10,o.name=i._getString(e,i.EVENT,null),o.bone=r,o.slot=n,a.push(o)}if(i.EVENTS in e)for(var l=e[i.EVENTS],h=0,u=l.length;h<u;++h){var _=l[h],f=i._getString(_,i.BONE,null),c=i._getString(_,i.SLOT,null),o=t.BaseObject.borrowObject(t.EventData);if(o.type=10,o.name=i._getString(_,i.NAME,null),o.bone=this._armature.getBone(f),o.slot=this._armature.getSlot(c),i.INTS in _){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var m=_[i.INTS],p=0,d=m.length;p<d;++p)o.data.ints.push(m[p])}if(i.FLOATS in _){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var y=_[i.FLOATS],g=0,v=y.length;g<v;++g)o.data.floats.push(y[g])}if(i.STRINGS in _){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var b=_[i.STRINGS],T=0,D=b.length;T<D;++T)o.data.strings.push(b[T])}a.push(o)}},i.prototype._parseTransform=function(e,a){a.x=i._getNumber(e,i.X,0)*this._armature.scale,a.y=i._getNumber(e,i.Y,0)*this._armature.scale,a.skewX=t.Transform.normalizeRadian(i._getNumber(e,i.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN),a.skewY=t.Transform.normalizeRadian(i._getNumber(e,i.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN),a.scaleX=i._getNumber(e,i.SCALE_X,1),a.scaleY=i._getNumber(e,i.SCALE_Y,1)},i.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*i._getNumber(t,i.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*i._getNumber(t,i.RED_MULTIPLIER,100),e.greenMultiplier=.01*i._getNumber(t,i.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*i._getNumber(t,i.BLUE_MULTIPLIER,100),e.alphaOffset=i._getNumber(t,i.ALPHA_OFFSET,0),e.redOffset=i._getNumber(t,i.RED_OFFSET,0),e.greenOffset=i._getNumber(t,i.GREEN_OFFSET,0),e.blueOffset=i._getNumber(t,i.BLUE_OFFSET,0)},i.prototype.parseDragonBonesData=function(e,a){if(void 0===a&&(a=1),e){var r=i._getString(e,i.VERSION,null),n=i._getString(e,i.COMPATIBLE_VERSION,null);if(this._isOldData=r===i.DATA_VERSION_2_3||r===i.DATA_VERSION_3_0,this._isOldData?this._isGlobalTransform=i._getBoolean(e,i.IS_GLOBAL,!0):this._isGlobalTransform=!1,i.DATA_VERSIONS.indexOf(r)>=0||i.DATA_VERSIONS.indexOf(n)>=0){var s=t.BaseObject.borrowObject(t.DragonBonesData);if(s.version=r,s.name=i._getString(e,i.NAME,null),s.frameRate=i._getNumber(e,i.FRAME_RATE,24),0===s.frameRate&&(s.frameRate=24),i.ARMATURE in e){this._data=s;for(var o=e[i.ARMATURE],l=0,h=o.length;l<h;++l)s.addArmature(this._parseArmature(o[l],a));this._data=null}return s}throw new Error("Nonsupport data version.")}throw new Error(t.DragonBones.ARGUMENT_ERROR)},i.prototype.parseTextureAtlasData=function(e,a,r){if(void 0===r&&(r=0),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);if(a.name=i._getString(e,i.NAME,null),a.imagePath=i._getString(e,i.IMAGE_PATH,null),a.width=i._getNumber(e,i.WIDTH,0),a.height=i._getNumber(e,i.HEIGHT,0),r>0?a.scale=r:r=a.scale=i._getNumber(e,i.SCALE,a.scale),r=1/r,i.SUB_TEXTURE in e)for(var n=e[i.SUB_TEXTURE],s=0,o=n.length;s<o;++s){var l=n[s],h=a.generateTexture();h.name=i._getString(l,i.NAME,null),h.rotated=i._getBoolean(l,i.ROTATED,!1),h.region.x=i._getNumber(l,i.X,0)*r,h.region.y=i._getNumber(l,i.Y,0)*r,h.region.width=i._getNumber(l,i.WIDTH,0)*r,h.region.height=i._getNumber(l,i.HEIGHT,0)*r;var u=i._getNumber(l,i.FRAME_WIDTH,-1),_=i._getNumber(l,i.FRAME_HEIGHT,-1);u>0&&_>0&&(h.frame=t.TextureData.generateRectangle(),h.frame.x=i._getNumber(l,i.FRAME_X,0)*r,h.frame.y=i._getNumber(l,i.FRAME_Y,0)*r,h.frame.width=u*r,h.frame.height=_*r),a.addTexture(h)}},i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i}(t.DataParser);e._instance=null,t.ObjectDataParser=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.globalTransformMatrix=new t.Matrix,i.global=new t.Transform,i.offset=new t.Transform,i}return r(i,e),i.prototype._onClear=function(){this.name=null,this.global.identity(),this.offset.identity(),this.globalTransformMatrix.identity(),this.origin=null,this.userData=null,this._armature=null,this._parent=null,this._globalDirty=!1},i.prototype._setArmature=function(t){this._armature=t},i.prototype._setParent=function(t){this._parent=t},i.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i}(t.BaseObject);e._helpPoint=new t.Point,e._helpTransform=new t.Transform,e._helpMatrix=new t.Matrix,t.TransformObject=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._animationPose=new t.Transform,i._bones=[],i._slots=[],i}return r(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.ikBendPositive=!1,this.ikWeight=0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._transformDirty=!1,this._childrenTransformDirty=!1,this._blendDirty=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendLayer=0,this._blendLeftWeight=1,this._blendTotalWeight=0,this._animationPose.identity(),this._bones.length=0,this._slots.length=0,this._boneData=null,this._cachedFrameIndices=null},i.prototype._updateGlobalTransformMatrix=function(e){var i=this._armature.flipX,a=this._armature.flipY===t.DragonBones.yDown,r=0;if(this.global.x=this.origin.x+this.offset.x+this._animationPose.x,this.global.y=this.origin.y+this.offset.y+this._animationPose.y,this.global.skewX=this.origin.skewX+this.offset.skewX+this._animationPose.skewX,
this.global.skewY=this.origin.skewY+this.offset.skewY+this._animationPose.skewY,this.global.scaleX=this.origin.scaleX*this.offset.scaleX*this._animationPose.scaleX,this.global.scaleY=this.origin.scaleY*this.offset.scaleY*this._animationPose.scaleY,this._parent){var n=this._parent.globalTransformMatrix;if(this._boneData.inheritScale)this._boneData.inheritRotation||(this._parent.updateGlobalTransform(),r=this._parent.global.skewY,this.global.skewX-=r,this.global.skewY-=r),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(n),this._boneData.inheritTranslation?(this.global.x=this.globalTransformMatrix.tx,this.global.y=this.globalTransformMatrix.ty):(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),e?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0;else{if(this._boneData.inheritTranslation){var s=this.global.x,o=this.global.y;this.global.x=n.a*s+n.c*o+n.tx,this.global.y=n.d*o+n.b*s+n.ty}else i&&(this.global.x=-this.global.x),a&&(this.global.y=-this.global.y);this._boneData.inheritRotation?(this._parent.updateGlobalTransform(),r=this._parent.global.skewY,this._armature._armatureData.isRightTransform&&n.a*n.d-n.b*n.c<0&&(r-=2*this.global.skewY,this._parent.global.scaleX<0&&(r+=Math.PI),(i!=a||this._boneData.inheritReflection)&&(this.global.skewX+=Math.PI)),this.global.skewX+=r,this.global.skewY+=r):(i||a)&&(i&&a?r=Math.PI:(r=2*-this.global.skewY,i&&(r+=Math.PI),this.global.skewX+=Math.PI),this.global.skewX+=r,this.global.skewY+=r),this.global.toMatrix(this.globalTransformMatrix)}}else(i||a)&&(i&&(this.global.x=-this.global.x),a&&(this.global.y=-this.global.y),i&&a?r=Math.PI:(r=2*-this.global.skewY,i&&(r+=Math.PI),this.global.skewX+=Math.PI),this.global.skewX+=r,this.global.skewY+=r),this.global.toMatrix(this.globalTransformMatrix);this._ik&&this._ikChainIndex===this._ikChain&&this.ikWeight>0&&(this._boneData.inheritTranslation&&this._ikChain>0&&this._parent?this._computeIKB():this._computeIKA())},i.prototype._computeIKA=function(){this.updateGlobalTransform();var t=this._boneData.length,e=this._ik.global,i=(this.globalTransformMatrix.a*t,this.globalTransformMatrix.b*t,Math.atan2(e.y-this.global.y,e.x-this.global.x));this.global.scaleX<0&&(i+=Math.PI);var a=(i-this.global.skewY)*this.ikWeight;this.global.skewX+=a,this.global.skewY+=a,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._computeIKB=function(){this._parent.updateGlobalTransform(),this.updateGlobalTransform();var t=this._boneData.length,e=this._parent.global,i=this._ik.global,a=this.globalTransformMatrix.a*t,r=this.globalTransformMatrix.b*t,n=a*a+r*r,s=Math.sqrt(n),o=this.global.x-e.x,l=this.global.y-e.y,h=o*o+l*l,u=Math.sqrt(h),_=Math.atan2(l,o);o=i.x-e.x,l=i.y-e.y;var f=o*o+l*l,c=Math.sqrt(f),m=0;if(s+u<=c||c+s<=u||c+u<=s)m=Math.atan2(i.y-e.y,i.x-e.x),s+u<=c||u<s&&(m+=Math.PI);else{var p=(h-n+f)/(2*f),d=Math.sqrt(h-p*p*f)/c,y=e.x+o*p,g=e.y+l*p,v=-l*d,b=o*d,T=!1;if(this._parent._parent){var D=this._parent._parent.globalTransformMatrix;T=D.a*D.d-D.b*D.c<0}T!==this.ikBendPositive?(this.global.x=y-v,this.global.y=g-b):(this.global.x=y+v,this.global.y=g+b),m=Math.atan2(this.global.y-e.y,this.global.x-e.x)}var O=(m-_)*this.ikWeight;e.skewX+=O,e.skewY+=O,e.toMatrix(this._parent.globalTransformMatrix),this._parent._childrenTransformDirty=!0,this._parent._cachedFrameIndex>=0&&this._armature._armatureData.setCacheFrame(this._parent.globalTransformMatrix,e,this._parent._cachedFrameIndex);var x=_+O;this.global.x=e.x+Math.cos(x)*u,this.global.y=e.y+Math.sin(x)*u;var S=Math.atan2(i.y-this.global.y,i.x-this.global.x);this.global.scaleX<0&&(S+=Math.PI),O=(S-this.global.skewY)*this.ikWeight,this.global.skewX+=O,this.global.skewY+=O,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._init=function(t){this._boneData||(this._boneData=t,this.name=this._boneData.name,this.origin=this._boneData.transform)},i.prototype._setArmature=function(t){if(this._armature!==t){this._ik=null;var e=null,i=null;if(this._armature&&(e=this.getSlots(),i=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this),e)for(var a=0,r=e.length;a<r;++a){var n=e[a];n.parent===this&&n._setArmature(this._armature)}if(i)for(var a=0,r=i.length;a<r;++a){var s=i[a];s.parent===this&&s._setArmature(this._armature)}}},i.prototype._setIK=function(t,e,i){if(t){if(e===i){var a=this._parent;if(e&&a?e=1:(e=0,i=0,a=this),a===t||a.contains(t))t=null,e=0,i=0;else for(var r=t;r.ik&&r.ikChain;){if(a.contains(r.ik)){t=null,e=0,i=0;break}r=r.parent}}}else e=0,i=0;this._ik=t,this._ikChain=e,this._ikChainIndex=i,this._armature&&(this._armature._bonesDirty=!0)},i.prototype._update=function(t){if(this._blendDirty=!1,t>=0&&this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent&&this._parent._childrenTransformDirty||this._ik&&this.ikWeight>0&&this._ik._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent&&this._parent._childrenTransformDirty||this._ik&&this.ikWeight>0&&this._ik._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var i=t>=0;this._updateGlobalTransformMatrix(i),i&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1)},i.prototype.invalidUpdate=function(){this._transformDirty=!0},i.prototype.contains=function(t){if(t){if(t===this)return!1;for(var e=t;e!==this&&e;)e=e.parent;return e===this}return!1},i.prototype.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,i=t.length;e<i;++e){var a=t[e];a.parent===this&&this._bones.push(a)}return this._bones},i.prototype.getSlots=function(){this._slots.length=0;for(var t=this._armature.getSlots(),e=0,i=t.length;e<i;++e){var a=t[e];a.parent===this&&this._slots.push(a)}return this._slots},Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=this._armature.getSlots(),i=0,a=e.length;i<a;++i){var r=e[i];r._parent===this&&r._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.boneData.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){for(var t=this._armature.getSlots(),e=0,i=t.length;e<i;++e){var a=t[e];if(a.parent===this)return a}return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ikChain",{get:function(){return this._ikChain},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ikChainIndex",{get:function(){return this._ikChainIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ik",{get:function(){return this._ik},enumerable:!0,configurable:!0}),i}(t.TransformObject);t.Bone=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._localMatrix=new t.Matrix,i._colorTransform=new t.ColorTransform,i._ffdVertices=[],i._displayList=[],i._textureDatas=[],i._replacedDisplayDatas=[],i._meshBones=[],i}return r(i,e),i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var i=[],a=0,r=this._displayList.length;a<r;++a){var n=this._displayList[a];n!==this._rawDisplay&&n!==this._meshDisplay&&i.indexOf(n)<0&&i.push(n)}for(var a=0,r=i.length;a<r;++a){var n=i[a];n instanceof t.Armature?n.dispose():this._disposeDisplay(n)}this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay),this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._meshDirty=!1,this._transformDirty=!1,this._blendMode=0,this._displayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._ffdVertices.length=0,this._displayList.length=0,this._textureDatas.length=0,this._replacedDisplayDatas.length=0,this._meshBones.length=0,this._skinSlotData=null,this._displayData=null,this._replacedDisplayData=null,this._textureData=null,this._meshData=null,this._boundingBoxData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._cachedFrameIndices=null},i.prototype._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones.length;t<e;++t)if(this._meshBones[t]._childrenTransformDirty)return!0;return!1},i.prototype._updateDisplayData=function(){var t=this._displayData,e=this._replacedDisplayData,a=this._textureData,r=this._meshData,n=this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayList[this._displayIndex]:null;if(this._displayIndex>=0&&this._displayIndex<this._skinSlotData.displays.length?this._displayData=this._skinSlotData.displays[this._displayIndex]:this._displayData=null,this._displayIndex>=0&&this._displayIndex<this._replacedDisplayDatas.length?this._replacedDisplayData=this._replacedDisplayDatas[this._displayIndex]:this._replacedDisplayData=null,this._displayData!==t||this._replacedDisplayData!==e||this._display!=n){var s=this._replacedDisplayData?this._replacedDisplayData:this._displayData;if(!s||n!==this._rawDisplay&&n!==this._meshDisplay)this._textureData=null,this._meshData=null,this._pivotX=0,this._pivotY=0,this._meshBones.length=0,this._ffdVertices.length=0;else{if(this._replacedDisplayData?this._textureData=this._replacedDisplayData.texture:this._displayIndex<this._textureDatas.length&&this._textureDatas[this._displayIndex]?this._textureData=this._textureDatas[this._displayIndex]:this._textureData=this._displayData.texture,n===this._meshDisplay?this._replacedDisplayData&&this._replacedDisplayData.mesh?this._meshData=this._replacedDisplayData.mesh:this._meshData=this._displayData.mesh:this._meshData=null,this._meshData)this._pivotX=0,this._pivotY=0;else if(this._textureData){var o=this._armature.armatureData.scale;if(this._pivotX=s.pivot.x,this._pivotY=s.pivot.y,s.isRelativePivot){var l=this._textureData.frame?this._textureData.frame:this._textureData.region,h=l.width*o,u=l.height*o;this._textureData.rotated&&(h=l.height,u=l.width),this._pivotX*=h,this._pivotY*=u}this._textureData.frame&&(this._pivotX+=this._textureData.frame.x*o,this._pivotY+=this._textureData.frame.y*o)}else this._pivotX=0,this._pivotY=0;if(!this._displayData||s===this._displayData||this._meshData&&this._meshData===this._displayData.mesh||(this._displayData.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,s.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y),this._meshData!==r)if(this._meshData&&this._displayData&&this._meshData===this._displayData.mesh){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var _=0,f=this._meshBones.length;_<f;++_)this._meshBones[_]=this._armature.getBone(this._meshData.bones[_].name);for(var c=0,_=0,f=this._meshData.boneIndices.length;_<f;++_)c+=this._meshData.boneIndices[_].length;this._ffdVertices.length=2*c}else this._meshBones.length=0,this._ffdVertices.length=this._meshData.vertices.length;for(var _=0,f=this._ffdVertices.length;_<f;++_)this._ffdVertices[_]=0;this._meshDirty=!0}else this._meshBones.length=0,this._ffdVertices.length=0;else this._textureData!==a&&(this._meshDirty=!0)}this._displayDirty=!0,this._transformDirty=!0,this._displayData?this.origin=this._displayData.transform:this._replacedDisplayData&&(this.origin=this._replacedDisplayData.transform)}this._replacedDisplayData?this._boundingBoxData=this._replacedDisplayData.boundingBox:this._displayData?this._boundingBoxData=this._displayData.boundingBox:this._boundingBoxData=null},i.prototype._updateDisplay=function(){var e=this._display||this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var a=this._display?this._display:this._rawDisplay;if(a!==e&&(this._onUpdateDisplay(),this._replaceDisplay(e),this._blendModeDirty=!0,this._colorDirty=!0),a!==this._rawDisplay&&a!==this._meshDisplay||this._updateFrame(),this._childArmature!==i&&(i&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var r=this._armature.cacheFrameRate;0!==r&&(this._childArmature.cacheFrameRate=r)}var n=this._skinSlotData.slot.actions.length>0?this._skinSlotData.slot.actions:this._childArmature.armatureData.actions;if(n.length>0)for(var s=0,o=n.length;s<o;++s)this._childArmature._bufferAction(n[s]);else this._childArmature.animation.play()}},i.prototype._updateGlobalTransformMatrix=function(t){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},i.prototype._init=function(t,e,i){if(!this._skinSlotData){this._skinSlotData=t;var a=this._skinSlotData.slot;this.name=a.name,this._zOrder=a.zOrder,this._blendMode=a.blendMode,this._colorTransform.copyFrom(a.color),this._rawDisplay=e,this._meshDisplay=i,this._blendModeDirty=!0,this._colorDirty=!0}},i.prototype._setArmature=function(t){this._armature!==t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},i.prototype._update=function(t){if(this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),t>=0&&this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._display){if(this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),this._meshData&&this._displayData&&this._meshData===this._displayData.mesh&&((this._meshDirty||this._meshData.skinned&&this._isMeshBonesUpdate())&&(this._meshDirty=!1,this._updateMesh()),this._meshData.skinned))return void(this._transformDirty&&(this._transformDirty=!1,this._updateTransform(!0)));if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var i=t>=0;this._updateGlobalTransformMatrix(i),i&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(!1)}}},i.prototype._updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},i.prototype._setDisplayList=function(e){if(e&&e.length>0){this._displayList.length!==e.length&&(this._displayList.length=e.length);for(var i=0,a=e.length;i<a;++i){var r=e[i];r&&r!==this._rawDisplay&&r!==this._meshDisplay&&!(r instanceof t.Armature)&&this._displayList.indexOf(r)<0&&this._initDisplay(r),this._displayList[i]=r}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=null!=this._display,this._updateDisplayData(),this._displayDirty},i.prototype._setDisplayIndex=function(t){return this._displayIndex!==t&&(this._displayIndex=t,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},i.prototype._setZorder=function(t){return this._zOrder===t,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,!0},i.prototype.containsPoint=function(t,e){return!!this._boundingBoxData&&(this._updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),this._boundingBoxData.containsPoint(i._helpPoint.x,i._helpPoint.y))},i.prototype.intersectsSegment=function(t,e,a,r,n,s,o){if(void 0===n&&(n=null),void 0===s&&(s=null),void 0===o&&(o=null),!this._boundingBoxData)return 0;this._updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),t=i._helpPoint.x,e=i._helpPoint.y,i._helpMatrix.transformPoint(a,r,i._helpPoint),a=i._helpPoint.x,r=i._helpPoint.y;var l=this._boundingBoxData.intersectsSegment(t,e,a,r,n,s,o);return l>0&&(1===l||2===l?n?(this.globalTransformMatrix.transformPoint(n.x,n.y,n),s&&(s.x=n.x,s.y=n.y)):s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s):(n&&this.globalTransformMatrix.transformPoint(n.x,n.y,n),s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s)),o&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),i._helpPoint,!0),o.x=Math.atan2(i._helpPoint.y,i._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),i._helpPoint,!0),o.y=Math.atan2(i._helpPoint.y,i._helpPoint.x))),l},i.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(i.prototype,"skinSlotData",{get:function(){return this._skinSlotData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this._update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),a=[];this._setDisplayList(e)&&this._update(-1);for(var r=0,n=i.length;r<n;++r){var s=i[r];s&&s!==this._rawDisplay&&s!==this._meshDisplay&&this._displayList.indexOf(s)<0&&a.indexOf(s)<0&&a.push(s)}for(var r=0,n=a.length;r<n;++r){var s=a[r];s instanceof t.Armature?s.dispose():this._disposeDisplay(s)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!==t){var e=this._displayList.length;if(this._displayIndex<0&&0===e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return this._display},i.prototype.setDisplay=function(t){this.display=t},i}(t.TransformObject);t.Slot=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._bones=[],t._slots=[],t._actions=[],t._events=[],t.enableCache=!1,t}return r(i,e),i.toString=function(){return"[class dragonBones.Armature]"},i._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},i.prototype._onClear=function(){for(var t=0,e=this._bones.length;t<e;++t)this._bones[t].returnToPool();for(var t=0,e=this._slots.length;t<e;++t)this._slots[t].returnToPool();for(var t=0,e=this._events.length;t<e;++t)this._events[t].returnToPool();this._clock&&this._clock.remove(this),this._proxy&&this._proxy._onClear(),this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this._animation&&this._animation.returnToPool(),this.inheritAnimation=!0,this.debugDraw=!1,this.userData=null,this._debugDraw=!1,this._delayDispose=!1,this._lockDispose=!1,this._bonesDirty=!1,this._slotsDirty=!1,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._bones.length=0,this._slots.length=0,this._actions.length=0,this._events.length=0,this._armatureData=null,this._skinData=null,this._animation=null,this._proxy=null,this._display=null,this._eventManager=null,this._parent=null,this._clock=null,this._replaceTextureAtlasData=null,this._replacedTexture=null},i.prototype._sortBones=function(){var t=this._bones.length;if(!(t<=0)){var e=this._bones.concat(),i=0,a=0;for(this._bones.length=0;a<t;){var r=e[i++];i>=t&&(i=0),this._bones.indexOf(r)>=0||r.parent&&this._bones.indexOf(r.parent)<0||r.ik&&this._bones.indexOf(r.ik)<0||(r.ik&&r.ikChain>0&&r.ikChainIndex===r.ikChain?this._bones.splice(this._bones.indexOf(r.parent)+1,0,r):this._bones.push(r),a++)}}},i.prototype._sortSlots=function(){this._slots.sort(i._onSortSlots)},i.prototype._doAction=function(t){switch(t.type){case 0:this._animation.playConfig(t.animationConfig)}},i.prototype._init=function(e,i,a,r,n){this._armatureData||(this._armatureData=e,this._skinData=i,this._animation=t.BaseObject.borrowObject(t.Animation),this._proxy=a,this._display=r,this._eventManager=n,this._animation._init(this),this._animation.animations=this._armatureData.animations)},i.prototype._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones.push(t),this._animation._timelineStateDirty=!0)},i.prototype._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);e>=0&&(this._bones.splice(e,1),this._animation._timelineStateDirty=!0)},i.prototype._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots.push(t),this._animation._timelineStateDirty=!0)},i.prototype._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);e>=0&&(this._slots.splice(e,1),this._animation._timelineStateDirty=!0)},i.prototype._sortZOrder=function(t){var e=this._armatureData.sortedSlots,i=!t||t.length<1;if(this._zOrderDirty||!i){for(var a=0,r=e.length;a<r;++a){var n=i?a:t[a],s=e[n];if(s){var o=this.getSlot(s.name);o&&o._setZorder(a)}}this._slotsDirty=!0,this._zOrderDirty=!i}},i.prototype._bufferAction=function(t){this._actions.push(t)},i.prototype._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},i.prototype.dispose=function(){this._armatureData&&(this._lockDispose?this._delayDispose=!0:this.returnToPool())},i.prototype.advanceTime=function(e){if(!this._armatureData)throw new Error("The armature has been disposed.");if(!this._armatureData.parent)throw new Error("The armature data has been disposed.");var i=this._animation._cacheFrameIndex;this._animation._advanceTime(e);var a=this._animation._cacheFrameIndex;this._bonesDirty&&(this._bonesDirty=!1,this._sortBones()),this._slotsDirty&&(this._slotsDirty=!1,this._sortSlots());var r=0,n=0;if(a<0||a!==i){for(r=0,n=this._bones.length;r<n;++r)this._bones[r]._update(a);for(r=0,n=this._slots.length;r<n;++r)this._slots[r]._update(a)}var s=this.debugDraw||t.DragonBones.debugDraw;if((s||this._debugDraw)&&(this._debugDraw=s,this._proxy._debugDraw(this._debugDraw)),!this._lockDispose){if(this._lockDispose=!0,n=this._events.length,n>0){for(r=0;r<n;++r){var o=this._events[r];this._proxy._dispatchEvent(o.type,o),o.type===t.EventObject.SOUND_EVENT&&this._eventManager._dispatchEvent(o.type,o),o.returnToPool()}this._events.length=0}if(n=this._actions.length,n>0){for(r=0;r<n;++r){var l=this._actions[r];if(l.slot){var h=this.getSlot(l.slot.name);if(h){var u=h.childArmature;u&&u._doAction(l)}}else if(l.bone)for(var _=0,f=this._slots.length;_<f;++_){var u=this._slots[_].childArmature;u&&u._doAction(l)}else this._doAction(l)}this._actions.length=0}this._lockDispose=!1}this._delayDispose&&this.returnToPool()},i.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var i=this.getBone(t);if(i&&(i.invalidUpdate(),e))for(var a=0,r=this._slots.length;a<r;++a){var n=this._slots[a];n.parent===i&&n.invalidUpdate()}}else{for(var a=0,r=this._bones.length;a<r;++a)this._bones[a].invalidUpdate();if(e)for(var a=0,r=this._slots.length;a<r;++a)this._slots[a].invalidUpdate()}},i.prototype.containsPoint=function(t,e){for(var i=0,a=this._slots.length;i<a;++i){var r=this._slots[i];if(r.containsPoint(t,e))return r}return null},i.prototype.intersectsSegment=function(t,e,i,a,r,n,s){void 0===r&&(r=null),void 0===n&&(n=null),void 0===s&&(s=null);for(var o=t===i,l=0,h=0,u=0,_=0,f=0,c=0,m=0,p=0,d=null,y=null,g=0,v=this._slots.length;g<v;++g){var b=this._slots[g],T=b.intersectsSegment(t,e,i,a,r,n,s);if(T>0){if(!r&&!n){d=b;break}if(r){var D=o?r.y-e:r.x-t;D<0&&(D=-D),(!d||D<l)&&(l=D,u=r.x,_=r.y,d=b,s&&(m=s.x))}if(n){var D=n.x-t;D<0&&(D=-D),(!y||D>h)&&(h=D,f=n.x,c=n.y,y=b,s&&(p=s.y))}}}return d&&r&&(r.x=u,r.y=_,s&&(s.x=m)),y&&n&&(n.x=f,n.y=c,s&&(s.y=p)),d},i.prototype.getBone=function(t){for(var e=0,i=this._bones.length;e<i;++e){var a=this._bones[e];if(a.name===t)return a}return null},i.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},i.prototype.getSlot=function(t){for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];if(a.name===t)return a}return null},i.prototype.getSlotByDisplay=function(t){if(t)for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];if(a.display===t)return a}return null},i.prototype.addBone=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setArmature(this),e._setParent(i?this.getBone(i):null)},i.prototype.removeBone=function(e){if(!e||e.armature!==this)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setParent(null),e._setArmature(null)},i.prototype.addSlot=function(e,i){var a=this.getBone(i);if(!a)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setArmature(this),e._setParent(a)},i.prototype.removeSlot=function(e){if(!e||e.armature!==this)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setParent(null),e._setArmature(null)},i.prototype.replaceTexture=function(t){this.replacedTexture=t},i.prototype.getBones=function(){return this._bones},i.prototype.getSlots=function(){return this._slots},Object.defineProperty(i.prototype,"name",{get:function(){return this._armatureData?this._armatureData.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e].childArmature;a&&(a.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;e&&e.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var i=0,a=this._slots.length;i<a;++i){var r=this._slots[i].childArmature;r&&(r.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];a.invalidUpdate(),a._update(-1)}}},enumerable:!0,configurable:!0}),i.prototype.hasEventListener=function(t){return this._proxy.hasEvent(t)},i.prototype.addEventListener=function(t,e,i){this._proxy.addEvent(t,e,i)},i.prototype.removeEventListener=function(t,e,i){this._proxy.removeEvent(t,e,i)},i.prototype.enableAnimationCache=function(t){this.cacheFrameRate=t},i.prototype.getDisplay=function(){return this._display},i}(t.BaseObject);t.Armature=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._animationNames=[],t._animations={},t._animationStates=[],t}return r(i,e),i._sortAnimationState=function(t,e){return t.layer>e.layer?-1:1},i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t=0,e=this._animationStates.length;t<e;++t)this._animationStates[t].returnToPool();this._animationConfig&&this._animationConfig.returnToPool();for(var i in this._animations)delete this._animations[i];this.timeScale=1,this._isPlaying=!1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._cacheFrameIndex=-1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._lastAnimationState=null,this._animationConfig=null},i.prototype._fadeOut=function(t){var e=0,i=this._animationStates.length,a=null;switch(t.fadeOutMode){case 1:for(;e<i;++e)a=this._animationStates[e],a.layer===t.layer&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 2:for(;e<i;++e)a=this._animationStates[e],a.group===t.group&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 3:for(;e<i;++e)a=this._animationStates[e],a.layer===t.layer&&a.group===t.group&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 4:for(;e<i;++e)a=this._animationStates[e],a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 0:}},i.prototype._init=function(e){this._armature||(this._armature=e,this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig))},i.prototype._advanceTime=function(t){if(this._isPlaying){t<0&&(t=-t),this._armature.inheritAnimation&&this._armature._parent&&(t*=this._armature._parent._armature.animation.timeScale),
1!==this.timeScale&&(t*=this.timeScale);var e=this._animationStates.length;if(1===e){var i=this._animationStates[0];if(i._fadeState>0&&i._subFadeState>0)i.returnToPool(),this._animationStates.length=0,this._animationStateDirty=!0,this._lastAnimationState=null;else{var a=i.animationData,r=a.cacheFrameRate;if(this._animationStateDirty&&r>0){this._animationStateDirty=!1;for(var n=this._armature.getBones(),s=0,o=n.length;s<o;++s){var l=n[s];l._cachedFrameIndices=a.getBoneCachedFrameIndices(l.name)}for(var h=this._armature.getSlots(),s=0,o=h.length;s<o;++s){var u=h[s];u._cachedFrameIndices=a.getSlotCachedFrameIndices(u.name)}}this._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,r)}}else if(e>1){for(var s=0,_=0;s<e;++s){var i=this._animationStates[s];i._fadeState>0&&i._subFadeState>0?(_++,i.returnToPool(),this._animationStateDirty=!0,this._lastAnimationState===i&&(this._lastAnimationState=null)):(_>0&&(this._animationStates[s-_]=i),this._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,0)),s===e-1&&_>0&&(this._animationStates.length-=_,!this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._cacheFrameIndex=-1}else this._cacheFrameIndex=-1;this._timelineStateDirty=!1}},i.prototype.reset=function(){for(var t=0,e=this._animationStates.length;t<e;++t)this._animationStates[t].returnToPool();this._isPlaying=!1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._cacheFrameIndex=-1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},i.prototype.stop=function(t){if(void 0===t&&(t=null),t){var e=this.getState(t);e&&e.stop()}else this._isPlaying=!1},i.prototype.playConfig=function(e){if(!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);var a=e.animation?e.animation:e.name,r=this._animations[a];if(!r)return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+a),null;this._isPlaying=!0,(e.fadeInTime<0||e.fadeInTime!==e.fadeInTime)&&(this._lastAnimationState?e.fadeInTime=r.fadeInTime:e.fadeInTime=0),(e.fadeOutTime<0||e.fadeOutTime!==e.fadeOutTime)&&(e.fadeOutTime=e.fadeInTime),(e.timeScale<=-100||e.timeScale!==e.timeScale)&&(e.timeScale=1/r.scale),r.frameCount>1?(e.position!==e.position?e.position=0:e.position<0?(e.position%=r.duration,e.position=r.duration-e.position):e.position===r.duration?e.position-=1e-6:e.position>r.duration&&(e.position%=r.duration),e.duration>0&&e.position+e.duration>r.duration&&(e.duration=r.duration-e.position),e.playTimes<0&&(e.playTimes=r.playTimes)):(e.playTimes=1,e.position=0,e.duration>0&&(e.duration=0));var n=!1;0===e.duration&&(e.duration=-1,n=!0),this._fadeOut(e),this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._init(this._armature,r,e),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._cacheFrameIndex=-1,this._animationStates.length>1&&this._animationStates.sort(i._sortAnimationState);for(var s=this._armature.getSlots(),o=0,l=s.length;o<l;++o){var h=s[o].childArmature;h&&h.inheritAnimation&&h.animation.hasAnimation(a)&&!h.animation.getState(a)&&h.animation.fadeIn(a)}return e.fadeInTime<=0&&this._armature.advanceTime(0),n&&this._lastAnimationState.stop(),this._lastAnimationState},i.prototype.fadeIn=function(t,e,i,a,r,n){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=0),void 0===r&&(r=null),void 0===n&&(n=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=n,this._animationConfig.playTimes=i,this._animationConfig.layer=a,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=r,this.playConfig(this._animationConfig)},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,t)this.playConfig(this._animationConfig);else if(this._lastAnimationState)this._isPlaying&&(this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted)?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):(this._isPlaying=!0,this._lastAnimationState.play());else{var i=this._armature.armatureData.defaultAnimation;i&&(this._animationConfig.animation=i.name,this.playConfig(this._animationConfig))}return this._lastAnimationState},i.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var a=this._animations[t];return a&&(this._animationConfig.position=a.duration*e/a.frameCount),this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var a=this._animations[t];return a&&(this._animationConfig.position=a.duration*(e>0?e:0)),this.playConfig(this._animationConfig)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return i&&i.stop(),i},i.prototype.getState=function(t){for(var e=0,i=this._animationStates.length;e<i;++e){var a=this._animationStates[e];if(a.name===t)return a}return null},i.prototype.hasAnimation=function(t){return null!=this._animations[t]},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._animationStates.length>1?this._isPlaying&&!this.isCompleted:this._lastAnimationState?this._isPlaying&&this._lastAnimationState.isPlaying:this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;t<e;++t)if(!this._animationStates[t].isCompleted)return!1;return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState?this._lastAnimationState.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){this._animationNames.length=0;for(var e in this._animations)delete this._animations[e];if(t)for(var e in t)this._animations[e]=t[e],this._animationNames.push(e)}},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,a,r,n,s,o,l){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=-1),void 0===r&&(r=0),void 0===n&&(n=null),void 0===s&&(s=3),void 0===o&&(o=!0),void 0===l&&(l=!0),this._animationConfig.clear(),this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=a,this._animationConfig.layer=r,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=n;var h=this._animations[t];return h&&i>0&&(this._animationConfig.timeScale=h.duration/i),this.playConfig(this._animationConfig)},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){for(var t=[],e=0,i=this._animationNames.length;e<i;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),i}(t.BaseObject);e.None=0,e.SameLayer=1,e.SameGroup=2,e.SameLayerAndGroup=3,e.All=4,t.Animation=e}(i||(i={}));var i;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._boneMask=[],t._animationNames=[],t._boneTimelines=[],t._slotTimelines=[],t._ffdTimelines=[],t.autoTween=!1,t}return r(i,e),i.toString=function(){return"[class dragonBones.AnimationState]"},i.prototype._onClear=function(){for(var t=0,e=this._boneTimelines.length;t<e;++t)this._boneTimelines[t].returnToPool();for(var t=0,e=this._slotTimelines.length;t<e;++t)this._slotTimelines[t].returnToPool();for(var t=0,e=this._ffdTimelines.length;t<e;++t)this._ffdTimelines[t].returnToPool();this._timeline&&this._timeline.returnToPool(),this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.displayControl=!0,this.additiveBlending=!1,this.actionEnabled=!1,this.playTimes=1,this.timeScale=1,this.weight=1,this.autoFadeOutTime=-1,this.fadeTotalTime=0,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._layer=0,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._name=null,this._group=null,this._boneMask.length=0,this._animationNames.length=0,this._boneTimelines.length=0,this._slotTimelines.length=0,this._ffdTimelines.length=0,this._animationData=null,this._armature=null,this._timeline=null,this._zOrderTimeline=null},i.prototype._advanceFadeTime=function(e){var i=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var a=i?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasEvent(a)){var r=t.BaseObject.borrowObject(t.EventObject);r.animationState=this,this._armature._bufferEvent(r,a)}}if(e<0&&(e=-e),this._fadeTime+=e,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=i?0:1):this._fadeTime>0?this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=i?1:0,this._subFadeState>0){i||(this._playheadState|=1,this._fadeState=0);var a=i?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasEvent(a)){var r=t.BaseObject.borrowObject(t.EventObject);r.animationState=this,this._armature._bufferEvent(r,a)}}},i.prototype._init=function(e,i,a){if(this._armature=e,this._animationData=i,this._name=a.name?a.name:a.animation,this.actionEnabled=a.actionEnabled,this.additiveBlending=a.additiveBlending,this.displayControl=a.displayControl,this.playTimes=a.playTimes,this.timeScale=a.timeScale,this.fadeTotalTime=a.fadeInTime,this.autoFadeOutTime=a.autoFadeOutTime,this.weight=a.weight,a.pauseFadeIn?this._playheadState=2:this._playheadState=3,this._fadeState=-1,this._subFadeState=-1,this._layer=a.layer,this._group=a.group,a.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==a.position?this.timeScale>=0?this._time=a.position:this._time=a.position-this._duration:this._time=0):(this._position=a.position,this._duration=a.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),a.boneMask.length>0){this._boneMask.length=a.boneMask.length;for(var r=0,n=this._boneMask.length;r<n;++r)this._boneMask[r]=a.boneMask[r]}if(a.animationNames.length>0){this._animationNames.length=a.animationNames.length;for(var r=0,n=this._animationNames.length;r<n;++r)this._animationNames[r]=a.animationNames[r]}this._timeline=t.BaseObject.borrowObject(t.AnimationTimelineState),this._timeline._init(this._armature,this,this._animationData),this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline._init(this._armature,this,this._animationData.zOrderTimeline)),this._updateTimelineStates()},i.prototype._updateTimelineStates=function(){for(var e={},i={},a={},r=0,n=this._boneTimelines.length;r<n;++r){var s=this._boneTimelines[r];e[s.bone.name]=s}for(var o=this._armature.getBones(),r=0,n=o.length;r<n;++r){var l=o[r],h=l.name;if(this.containsBoneMask(h)){var u=this._animationData.getBoneTimeline(h);if(u)if(e[h])delete e[h];else{var s=t.BaseObject.borrowObject(t.BoneTimelineState);s.bone=l,s._init(this._armature,this,u),this._boneTimelines.push(s)}}}for(var _ in e){var s=e[_];s.bone.invalidUpdate(),this._boneTimelines.splice(this._boneTimelines.indexOf(s),1),s.returnToPool()}for(var r=0,n=this._slotTimelines.length;r<n;++r){var f=this._slotTimelines[r];i[f.slot.name]=f}for(var r=0,n=this._ffdTimelines.length;r<n;++r){var c=this._ffdTimelines[r],m=c._timelineData.display,p=m.inheritAnimation?m.mesh.name:m.name;a[p]=c}for(var d=this._armature.getSlots(),r=0,n=d.length;r<n;++r){var y=d[r],g=y.name,v=y.parent.name,b=!1;if(this.containsBoneMask(v)){var T=this._animationData.getSlotTimeline(g);if(T)if(i[g])delete i[g];else{var f=t.BaseObject.borrowObject(t.SlotTimelineState);f.slot=y,f._init(this._armature,this,T),this._slotTimelines.push(f)}var D=this._animationData.getFFDTimeline(this._armature._skinData.name,g);if(D)for(var _ in D)if(a[_])delete a[_];else{var c=t.BaseObject.borrowObject(t.FFDTimelineState);c.slot=y,c._init(this._armature,this,D[_]),this._ffdTimelines.push(c)}else b=!0}else b=!0;if(b){for(var O=0,x=y._ffdVertices.length;O<x;++O)y._ffdVertices[O]=0;y._meshDirty=!0}}for(var _ in i){var f=i[_];this._slotTimelines.splice(this._slotTimelines.indexOf(f),1),f.returnToPool()}for(var _ in a){var c=a[_];this._ffdTimelines.splice(this._ffdTimelines.indexOf(c),1),c.returnToPool()}},i.prototype._advanceTime=function(t,e){if(0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(t),1!==this.timeScale&&(t*=this.timeScale),0!==t&&3===this._playheadState&&(this._time+=t),0!==this.weight){var i=0===this._fadeState&&e>0,a=!0,r=!0,n=this._time;if(this._weightResult=this.weight*this._fadeProgress,this._timeline.update(n),i){var s=2*e;this._timeline._currentTime=Math.floor(this._timeline._currentTime*s)/s}if(this._zOrderTimeline&&this._zOrderTimeline.update(n),i){var o=Math.floor(this._timeline._currentTime*e);this._armature.animation._cacheFrameIndex===o?(a=!1,r=!1):(this._armature.animation._cacheFrameIndex=o,this._animationData.cachedFrames[o]?r=!1:this._animationData.cachedFrames[o]=!0)}if(a){if(r)for(var l=0,h=this._boneTimelines.length;l<h;++l)this._boneTimelines[l].update(n);for(var l=0,h=this._slotTimelines.length;l<h;++l)this._slotTimelines[l].update(n);for(var l=0,h=this._ffdTimelines.length;l<h;++l)this._ffdTimelines[l].update(n)}}0===this._fadeState&&(this._subFadeState>0&&(this._subFadeState=0),this._timeline._playState>0&&(this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime),this._animationNames.length>0))},i.prototype._isDisabled=function(t){return!(this.displayControl&&(!t.displayController||t.displayController===this._name||t.displayController===this._group))},i.prototype.play=function(){this._playheadState=3},i.prototype.stop=function(){this._playheadState&=1},i.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),(t<0||t!==t)&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,a=this._boneTimelines.length;i<a;++i)this._boneTimelines[i].fadeOut();for(var i=0,a=this._slotTimelines.length;i<a;++i)this._slotTimelines[i].fadeOut();for(var i=0,a=this._ffdTimelines.length;i<a;++i)this._ffdTimelines[i].fadeOut()}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},i.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||this._boneMask.indexOf(t)>=0},i.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var a=this._armature.getBones(),r=0,n=a.length;r<n;++r){var s=a[r];this._boneMask.indexOf(s.name)<0&&i.contains(s)&&this._boneMask.push(s.name)}this._updateTimelineStates()}},i.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var a=this._armature.getBone(t);if(a){var r=this._armature.getBones();if(this._boneMask.length>0)for(var n=0,s=r.length;n<s;++n){var o=r[n],l=this._boneMask.indexOf(o.name);l>=0&&a.contains(o)&&this._boneMask.splice(l,1)}else for(var n=0,s=r.length;n<s;++n){var o=r[n];a.contains(o)||this._boneMask.push(o.name)}}}this._updateTimelineStates()},i.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},Object.defineProperty(i.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){return this._timeline._playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return 2&this._playheadState&&this._timeline._playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._timeline._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._timeline._currentTime},set:function(t){t!==t&&(t=0);var e=this._timeline._currentPlayTimes-(this._timeline._playState>0?1:0);if(t=t%this._duration+e*this._duration,t<0&&(t+=this._duration),this._time!==t){this._time=t,this._timeline.setCurrentTime(this._time),this._zOrderTimeline&&(this._zOrderTimeline._playState=-1);for(var i=0,a=this._boneTimelines.length;i<a;++i)this._boneTimelines[i]._playState=-1;for(var i=0,a=this._slotTimelines.length;i<a;++i)this._slotTimelines[i]._playState=-1;for(var i=0,a=this._ffdTimelines.length;i<a;++i)this._ffdTimelines[i]._playState=-1}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clip",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.AnimationState=e}(i||(i={}));var i;!function(t){var e=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype._onClear=function(){this._playState=-1,this._currentPlayTimes=0,this._currentTime=-1,this._timelineData=null,this._frameRate=0,this._frameCount=0,this._position=0,this._duration=0,this._animationDutation=0,this._timeScale=1,this._timeOffset=0,this._currentFrame=null,this._armature=null,this._animationState=null,this._mainTimeline=null},e.prototype._onUpdateFrame=function(){},e.prototype._onArriveAtFrame=function(){},e.prototype._setCurrentTime=function(t){var e=this._playState,i=0,a=0;if(this._mainTimeline&&1===this._frameCount)this._playState=this._mainTimeline._playState>=0?1:-1,i=1,a=this._mainTimeline._currentTime;else if(this._mainTimeline&&1===this._timeScale&&0===this._timeOffset)this._playState=this._mainTimeline._playState,i=this._mainTimeline._currentPlayTimes,a=this._mainTimeline._currentTime;else{var r=this._animationState.playTimes,n=r*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationDutation),r>0&&(t>=n||t<=-n)?(this._playState<=0&&3===this._animationState._playheadState&&(this._playState=1),i=r,a=t<0?0:this._duration):(0!==this._playState&&3===this._animationState._playheadState&&(this._playState=0),t<0?(t=-t,i=Math.floor(t/this._duration),a=this._duration-t%this._duration):(i=Math.floor(t/this._duration),a=t%this._duration)),a+=this._position}return(this._currentPlayTimes!==i||this._currentTime!==a)&&((e<0&&this._playState!==e||this._playState<=0&&this._currentPlayTimes!==i)&&(this._currentFrame=null),this._currentPlayTimes=i,this._currentTime=a,!0)},e.prototype._init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._mainTimeline=this._animationState._timeline,this===this._mainTimeline&&(this._mainTimeline=null),this._frameRate=this._armature.armatureData.frameRate,this._frameCount=this._timelineData.frames.length,this._position=this._animationState._position,this._duration=this._animationState._duration,this._animationDutation=this._animationState.animationData.duration,this._timeScale=this._mainTimeline?1/this._timelineData.scale:1,this._timeOffset=this._mainTimeline?this._timelineData.offset:0},e.prototype.fadeOut=function(){},e.prototype.update=function(t){if(this._playState<=0&&this._setCurrentTime(t)){var e=this._frameCount>1?Math.floor(this._currentTime*this._frameRate):0,i=this._timelineData.frames[e];this._currentFrame!==i&&(this._currentFrame=i,this._onArriveAtFrame()),this._onUpdateFrame()}},e}(t.BaseObject);t.TimelineState=e;var i=function(e){function i(){return e.call(this)||this}return r(i,e),i._getEasingValue=function(t,e){if(t<=0)return 0;if(t>=1)return 1;var i=1;if(e>2)return t;if(e>1)i=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)i=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,i=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,i=Math.acos(1-2*t)/Math.PI,e-=1}return(i-t)*e+t},i._getEasingCurveValue=function(t,e){if(t<=0)return 0;if(t>=1)return 1;var i=e.length+1,a=Math.floor(t*i),r=0===a?0:e[a-1],n=a===i-1?1:e[a];return r+(n-r)*(t*i-a)},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},i.prototype._onArriveAtFrame=function(){this._frameCount>1&&(this._currentFrame.next!==this._timelineData.frames[0]||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1)?(this._tweenEasing=this._currentFrame.tweenEasing,this._curve=this._currentFrame.curve):(this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null)},i.prototype._onUpdateFrame=function(){this._tweenEasing!==t.DragonBones.NO_TWEEN?(this._tweenProgress=(this._currentTime-this._currentFrame.position)/this._currentFrame.duration,0!==this._tweenEasing&&(this._tweenProgress=i._getEasingValue(this._tweenProgress,this._tweenEasing))):this._curve?(this._tweenProgress=(this._currentTime-this._currentFrame.position)/this._currentFrame.duration,this._tweenProgress=i._getEasingCurveValue(this._tweenProgress,this._curve)):this._tweenProgress=0},i}(e);t.TweenTimelineState=i}(i||(i={}));var i;!function(t){var e=function(e){function i(){return e.call(this)||this}return r(i,e),i.toString=function(){return"[class dragonBones.AnimationTimelineState]"},i.prototype._onCrossFrame=function(e){if(this._animationState.actionEnabled)for(var i=e.actions,a=0,r=i.length;a<r;++a)this._armature._bufferAction(i[a]);for(var n=this._armature.eventDispatcher,s=e.events,a=0,r=s.length;a<r;++a){var o=s[a],l=null;switch(o.type){case 10:l=t.EventObject.FRAME_EVENT;break;case 11:l=t.EventObject.SOUND_EVENT}if(n.hasEvent(l)||11===o.type){var h=t.BaseObject.borrowObject(t.EventObject);h.name=o.name,h.frame=e,h.data=o.data,h.animationState=this._animationState,o.bone&&(h.bone=this._armature.getBone(o.bone.name)),o.slot&&(h.slot=this._armature.getSlot(o.slot.name)),this._armature._bufferEvent(h,l)}}},i.prototype.update=function(e){var i=this._playState,a=this._currentPlayTimes,r=this._currentTime;if(this._playState<=0&&this._setCurrentTime(e)){var n=this._armature.eventDispatcher;if(i<0&&this._playState!==i&&(this._animationState.displayControl&&this._armature._sortZOrder(null),n.hasEvent(t.EventObject.START))){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this._animationState,this._armature._bufferEvent(s,t.EventObject.START)}if(r<0)return;var o=!1,l=null,h=null;if(this._currentPlayTimes!==a?(n.hasEvent(t.EventObject.LOOP_COMPLETE)&&(l=t.BaseObject.borrowObject(t.EventObject),l.animationState=this._animationState),this._playState>0?(n.hasEvent(t.EventObject.COMPLETE)&&(h=t.BaseObject.borrowObject(t.EventObject),h.animationState=this._animationState),o=r>this._currentTime):o=r<this._currentTime):o=r>this._currentTime,this._frameCount>1){var u=Math.floor(this._currentTime*this._frameRate),_=this._timelineData.frames[u];if(this._currentFrame!==_){var f=this._currentFrame;if(this._currentFrame=_,o){if(!f){var c=Math.floor(r*this._frameRate);f=this._timelineData.frames[c],this._currentPlayTimes===a&&f===_&&(f=null)}for(;f&&(this._position<=f.position&&f.position<=this._position+this._duration&&this._onCrossFrame(f),l&&f===this._timelineData.frames[0]&&(this._armature._bufferEvent(l,t.EventObject.LOOP_COMPLETE),l=null),f=f.prev,f!==_););}else{if(!f){var c=Math.floor(r*this._frameRate);f=this._timelineData.frames[c],this._currentPlayTimes===a&&(r<=f.position?f=f.prev:f===_&&(f=null))}for(;f&&(f=f.next,l&&f===this._timelineData.frames[0]&&(this._armature._bufferEvent(l,t.EventObject.LOOP_COMPLETE),l=null),this._position<=f.position&&f.position<=this._position+this._duration&&this._onCrossFrame(f),f!==_););}}}else this._frameCount>0&&!this._currentFrame&&(this._currentFrame=this._timelineData.frames[0],this._currentPlayTimes===a?r<=this._currentFrame.position&&this._onCrossFrame(this._currentFrame):this._position<=this._currentFrame.position&&(!o&&l&&(this._armature._bufferEvent(l,t.EventObject.LOOP_COMPLETE),l=null),this._onCrossFrame(this._currentFrame)));l&&(this._armature._bufferEvent(l,t.EventObject.LOOP_COMPLETE),l=null),h&&(this._armature._bufferEvent(h,t.EventObject.COMPLETE),h=null)}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._currentFrame=null},i}(t.TimelineState);t.AnimationTimelineState=e;var i=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this),this._armature._sortZOrder(this._currentFrame.zOrder)},e}(t.TimelineState);t.ZOrderTimelineState=i;var a=function(e){function i(){var i=e.call(this)||this;return i._transform=new t.Transform,i._durationTransform=new t.Transform,i}return r(i,e),i.toString=function(){return"[class dragonBones.BoneTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this._transformDirty=!1,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._transform.identity(),this._durationTransform.identity(),this._boneTransform=null,this._originalTransform=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this._tweenTransform=1,this._tweenRotate=1,this._tweenScale=1,this._frameCount>1&&(this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve)){var i=this._currentFrame.transform,a=this._currentFrame.next,r=a.transform;this._durationTransform.x=r.x-i.x,this._durationTransform.y=r.y-i.y,0===this._durationTransform.x&&0===this._durationTransform.y||(this._tweenTransform=2);var n=this._currentFrame.tweenRotate;n!==t.DragonBones.NO_TWEEN?(n?((n>0?r.skewY>=i.skewY:r.skewY<=i.skewY)&&(n=n>0?n-1:n+1),this._durationTransform.skewX=r.skewX-i.skewX+t.DragonBones.PI_D*n,this._durationTransform.skewY=r.skewY-i.skewY+t.DragonBones.PI_D*n):(this._durationTransform.skewX=t.Transform.normalizeRadian(r.skewX-i.skewX),this._durationTransform.skewY=t.Transform.normalizeRadian(r.skewY-i.skewY)),0===this._durationTransform.skewX&&0===this._durationTransform.skewY||(this._tweenRotate=2)):(this._durationTransform.skewX=0,this._durationTransform.skewY=0),this._currentFrame.tweenScale?(this._durationTransform.scaleX=r.scaleX-i.scaleX,this._durationTransform.scaleY=r.scaleY-i.scaleY,0===this._durationTransform.scaleX&&0===this._durationTransform.scaleY||(this._tweenScale=2)):(this._durationTransform.scaleX=0,this._durationTransform.scaleY=0)}else this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationTransform.scaleX=0,this._durationTransform.scaleY=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var i=0,a=this._currentFrame.transform;0!==this._tweenTransform&&(1===this._tweenTransform?(this._tweenTransform=0,i=0):i=this._tweenProgress,this._animationState.additiveBlending?(this._transform.x=a.x+this._durationTransform.x*i,this._transform.y=a.y+this._durationTransform.y*i):(this._transform.x=this._originalTransform.x+a.x+this._durationTransform.x*i,this._transform.y=this._originalTransform.y+a.y+this._durationTransform.y*i),this._transformDirty=!0),0!==this._tweenRotate&&(1===this._tweenRotate?(this._tweenRotate=0,i=0):i=this._tweenProgress,this._animationState.additiveBlending?(this._transform.skewX=a.skewX+this._durationTransform.skewX*i,this._transform.skewY=a.skewY+this._durationTransform.skewY*i):(this._transform.skewX=t.Transform.normalizeRadian(this._originalTransform.skewX+a.skewX+this._durationTransform.skewX*i),this._transform.skewY=t.Transform.normalizeRadian(this._originalTransform.skewY+a.skewY+this._durationTransform.skewY*i)),this._transformDirty=!0),0!==this._tweenScale&&(1===this._tweenScale?(this._tweenScale=0,i=0):i=this._tweenProgress,this._animationState.additiveBlending?(this._transform.scaleX=a.scaleX+this._durationTransform.scaleX*i,this._transform.scaleY=a.scaleY+this._durationTransform.scaleY*i):(this._transform.scaleX=this._originalTransform.scaleX*(a.scaleX+this._durationTransform.scaleX*i),this._transform.scaleY=this._originalTransform.scaleY*(a.scaleY+this._durationTransform.scaleY*i)),this._transformDirty=!0)},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._originalTransform=this._timelineData.originalTransform,this._boneTransform=this.bone._animationPose},i.prototype.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},i.prototype.update=function(t){var i=this._animationState._layer,a=this._animationState._weightResult;this.bone._blendDirty?this.bone._blendLeftWeight>0&&(this.bone._blendLayer!==i&&(this.bone._blendTotalWeight>=this.bone._blendLeftWeight?this.bone._blendLeftWeight=0:(this.bone._blendLayer=i,this.bone._blendLeftWeight-=this.bone._blendTotalWeight,this.bone._blendTotalWeight=0)),a*=this.bone._blendLeftWeight,a>=0&&(e.prototype.update.call(this,t),this.bone._blendTotalWeight+=a,this._boneTransform.x+=this._transform.x*a,this._boneTransform.y+=this._transform.y*a,this._boneTransform.skewX+=this._transform.skewX*a,this._boneTransform.skewY+=this._transform.skewY*a,this._boneTransform.scaleX+=(this._transform.scaleX-1)*a,this._boneTransform.scaleY+=(this._transform.scaleY-1)*a)):(e.prototype.update.call(this,t),this.bone._blendLayer=i,this.bone._blendLeftWeight=1,this.bone._blendTotalWeight=a,this._boneTransform.x=this._transform.x*a,this._boneTransform.y=this._transform.y*a,this._boneTransform.skewX=this._transform.skewX*a,this._boneTransform.skewY=this._transform.skewY*a,this._boneTransform.scaleX=(this._transform.scaleX-1)*a+1,this._boneTransform.scaleY=(this._transform.scaleY-1)*a+1,this.bone._blendDirty=!0),(this._transformDirty||0!==this._animationState._fadeState||0!==this._animationState._subFadeState)&&(this._transformDirty=!1,this.bone.invalidUpdate())},i}(t.TweenTimelineState);t.BoneTimelineState=a;
var n=function(e){function i(){var i=e.call(this)||this;return i._color=new t.ColorTransform,i._durationColor=new t.ColorTransform,i}return r(i,e),i.toString=function(){return"[class dragonBones.SlotTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._color.identity(),this._durationColor.identity(),this._slotColor=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this._animationState._isDisabled(this.slot))return this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,void(this._tweenColor=0);var i=this._currentFrame.displayIndex;if(this._playState>=0&&this.slot.displayIndex!==i&&this.slot._setDisplayIndex(i),i>=0){this._tweenColor=0;var a=this._currentFrame.color;if(this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve){var r=this._currentFrame.next,n=r.color;a!==n&&(this._durationColor.alphaMultiplier=n.alphaMultiplier-a.alphaMultiplier,this._durationColor.redMultiplier=n.redMultiplier-a.redMultiplier,this._durationColor.greenMultiplier=n.greenMultiplier-a.greenMultiplier,this._durationColor.blueMultiplier=n.blueMultiplier-a.blueMultiplier,this._durationColor.alphaOffset=n.alphaOffset-a.alphaOffset,this._durationColor.redOffset=n.redOffset-a.redOffset,this._durationColor.greenOffset=n.greenOffset-a.greenOffset,this._durationColor.blueOffset=n.blueOffset-a.blueOffset,0===this._durationColor.alphaMultiplier&&0===this._durationColor.redMultiplier&&0===this._durationColor.greenMultiplier&&0===this._durationColor.blueMultiplier&&0===this._durationColor.alphaOffset&&0===this._durationColor.redOffset&&0===this._durationColor.greenOffset&&0===this._durationColor.blueOffset||(this._tweenColor=2))}0===this._tweenColor&&(this._slotColor.alphaMultiplier===a.alphaMultiplier&&this._slotColor.redMultiplier===a.redMultiplier&&this._slotColor.greenMultiplier===a.greenMultiplier&&this._slotColor.blueMultiplier===a.blueMultiplier&&this._slotColor.alphaOffset===a.alphaOffset&&this._slotColor.redOffset===a.redOffset&&this._slotColor.greenOffset===a.greenOffset&&this._slotColor.blueOffset===a.blueOffset||(this._tweenColor=1))}else this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,this._tweenColor=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=0;if(0!==this._tweenColor&&this.slot.parent._blendLayer>=this._animationState._layer){1===this._tweenColor?(this._tweenColor=0,t=0):t=this._tweenProgress;var i=this._currentFrame.color;this._color.alphaMultiplier=i.alphaMultiplier+this._durationColor.alphaMultiplier*t,this._color.redMultiplier=i.redMultiplier+this._durationColor.redMultiplier*t,this._color.greenMultiplier=i.greenMultiplier+this._durationColor.greenMultiplier*t,this._color.blueMultiplier=i.blueMultiplier+this._durationColor.blueMultiplier*t,this._color.alphaOffset=i.alphaOffset+this._durationColor.alphaOffset*t,this._color.redOffset=i.redOffset+this._durationColor.redOffset*t,this._color.greenOffset=i.greenOffset+this._durationColor.greenOffset*t,this._color.blueOffset=i.blueOffset+this._durationColor.blueOffset*t,this._colorDirty=!0}},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._slotColor=this.slot._colorTransform},i.prototype.fadeOut=function(){this._tweenColor=0},i.prototype.update=function(t){if(e.prototype.update.call(this,t),0!==this._tweenColor||this._colorDirty)if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){var i=Math.pow(this._animationState._fadeProgress,4);this._slotColor.alphaMultiplier+=(this._color.alphaMultiplier-this._slotColor.alphaMultiplier)*i,this._slotColor.redMultiplier+=(this._color.redMultiplier-this._slotColor.redMultiplier)*i,this._slotColor.greenMultiplier+=(this._color.greenMultiplier-this._slotColor.greenMultiplier)*i,this._slotColor.blueMultiplier+=(this._color.blueMultiplier-this._slotColor.blueMultiplier)*i,this._slotColor.alphaOffset+=(this._color.alphaOffset-this._slotColor.alphaOffset)*i,this._slotColor.redOffset+=(this._color.redOffset-this._slotColor.redOffset)*i,this._slotColor.greenOffset+=(this._color.greenOffset-this._slotColor.greenOffset)*i,this._slotColor.blueOffset+=(this._color.blueOffset-this._slotColor.blueOffset)*i,this.slot._colorDirty=!0}else this._colorDirty&&(this._colorDirty=!1,this._slotColor.alphaMultiplier=this._color.alphaMultiplier,this._slotColor.redMultiplier=this._color.redMultiplier,this._slotColor.greenMultiplier=this._color.greenMultiplier,this._slotColor.blueMultiplier=this._color.blueMultiplier,this._slotColor.alphaOffset=this._color.alphaOffset,this._slotColor.redOffset=this._color.redOffset,this._slotColor.greenOffset=this._color.greenOffset,this._slotColor.blueOffset=this._color.blueOffset,this.slot._colorDirty=!0)},i}(t.TweenTimelineState);t.SlotTimelineState=n;var s=function(e){function i(){var t=e.call(this)||this;return t._ffdVertices=[],t._durationFFDVertices=[],t}return r(i,e),i.toString=function(){return"[class dragonBones.FFDTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._ffdDirty=!1,this._tweenFFD=0,this._ffdVertices.length=0,this._durationFFDVertices.length=0,this._slotFFDVertices=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this.slot.displayIndex>=0&&this._animationState._isDisabled(this.slot))return this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,void(this._tweenFFD=0);if(this._tweenFFD=0,this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve)for(var i=this._currentFrame.tweens,a=this._currentFrame.next.tweens,r=0,n=i.length;r<n;++r){var s=a[r]-i[r];this._durationFFDVertices[r]=s,0!==s&&(this._tweenFFD=2)}if(0===this._tweenFFD){this._tweenFFD=1;for(var r=0,n=this._durationFFDVertices.length;r<n;++r)this._durationFFDVertices[r]=0}},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=0;if(0!==this._tweenFFD&&this.slot.parent._blendLayer>=this._animationState._layer){1===this._tweenFFD?(this._tweenFFD=0,t=0):t=this._tweenProgress;for(var i=this._currentFrame.tweens,a=0,r=i.length;a<r;++a)this._ffdVertices[a]=i[a]+this._durationFFDVertices[a]*t;this._ffdDirty=!0}},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._slotFFDVertices=this.slot._ffdVertices,this._ffdVertices.length=this._timelineData.frames[0].tweens.length,this._durationFFDVertices.length=this._ffdVertices.length;for(var r=0,n=this._ffdVertices.length;r<n;++r)this._ffdVertices[r]=0;for(var r=0,n=this._durationFFDVertices.length;r<n;++r)this._durationFFDVertices[r]=0},i.prototype.fadeOut=function(){this._tweenFFD=0},i.prototype.update=function(t){if(e.prototype.update.call(this,t),this.slot._meshData===this._timelineData.display.mesh&&(0!==this._tweenFFD||this._ffdDirty))if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(var i=Math.pow(this._animationState._fadeProgress,4),a=0,r=this._ffdVertices.length;a<r;++a)this._slotFFDVertices[a]+=(this._ffdVertices[a]-this._slotFFDVertices[a])*i;this.slot._meshDirty=!0}else if(this._ffdDirty){this._ffdDirty=!1;for(var a=0,r=this._ffdVertices.length;a<r;++a)this._slotFFDVertices[a]=this._ffdVertices[a];this.slot._meshDirty=!0}},i}(t.TweenTimelineState);t.FFDTimelineState=s}(i||(i={}));var i;!function(t){var e=function(){function e(){this.time=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[],this._clock=null}return Object.defineProperty(e,"clock",{get:function(){return e._clock||(e._clock=new e),e._clock},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(e){if(e!==e&&(e=0),e<0&&(e=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND-this.time),1!==this.timeScale&&(e*=this.timeScale),e<0?this.time-=e:this.time+=e,e){for(var i=0,a=0,r=this._animatebles.length;i<r;++i){var n=this._animatebles[i];n?(a>0&&(this._animatebles[i-a]=n,this._animatebles[i]=null),n.advanceTime(e)):a++}if(a>0){for(r=this._animatebles.length;i<r;++i){var n=this._animatebles[i];n?this._animatebles[i-a]=n:a++}this._animatebles.length-=a}}},e.prototype.contains=function(t){return this._animatebles.indexOf(t)>=0},e.prototype.add=function(e){e&&this._animatebles.indexOf(e)<0&&(this._animatebles.push(e),e.clock=this,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.addArmature(e))},e.prototype.remove=function(e){var i=this._animatebles.indexOf(e);i>=0&&(this._animatebles[i]=null,e.clock=null,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.removeArmature(e))},e.prototype.clear=function(){for(var t=0,e=this._animatebles.length;t<e;++t){var i=this._animatebles[t];this._animatebles[t]=null,null!=i&&(i.clock=null)}},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;e&&e.remove(this),this._clock=t,this._clock&&this._clock.add(this)}},enumerable:!0,configurable:!0}),e}();e._clock=null,t.WorldClock=e}(i||(i={}));var i;!function(t){var e=function(t){function e(){return t.call(this)||this}return r(e,t),e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.type=null,this.name=null,this.frame=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null},e}(t.BaseObject);e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",t.EventObject=e}(i||(i={}));var i;!function(t){var e=function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dataParser=null,this._dataParser=i,this._dataParser||(e._defaultParser||(e._defaultParser=new t.ObjectDataParser),this._dataParser=e._defaultParser)}return e.prototype._getTextureData=function(t,e){var i=this._textureAtlasDataMap[t];if(i)for(var a=0,r=i.length;a<r;++a){var n=i[a].getTexture(e);if(n)return n}if(this.autoSearch)for(var s in this._textureAtlasDataMap){i=this._textureAtlasDataMap[s];for(var a=0,r=i.length;a<r;++a){var o=i[a];if(o.autoSearch){var n=o.getTexture(e);if(n)return n}}}return null},e.prototype._fillBuildArmaturePackage=function(t,e,i,a,r){var n=null,s=null;if(e&&(n=this._dragonBonesDataMap[e],n&&(s=n.getArmature(i))),!s&&(!e||this.autoSearch))for(var o in this._dragonBonesDataMap)if(n=this._dragonBonesDataMap[o],(!e||n.autoSearch)&&(s=n.getArmature(i))){e=o;break}return!!s&&(t.dataName=e,t.textureAtlasName=r,t.data=n,t.armature=s,t.skin=s.getSkin(a),t.skin||(t.skin=s.defaultSkin),!0)},e.prototype._buildBones=function(e,i){for(var a=e.armature.sortedBones,r=0,n=a.length;r<n;++r){var s=a[r],o=t.BaseObject.borrowObject(t.Bone);o._init(s),s.parent?i.addBone(o,s.parent.name):i.addBone(o),s.ik&&(o.ikBendPositive=s.bendPositive,o.ikWeight=s.weight,o._setIK(i.getBone(s.ik.name),s.chain,s.chainIndex))}},e.prototype._buildSlots=function(t,e){var i=t.skin,a=t.armature.defaultSkin;if(i&&a){var r={};for(var n in a.slots){var s=a.slots[n];r[s.slot.name]=s}if(i!==a)for(var n in i.slots){var s=i.slots[n];r[s.slot.name]=s}for(var o=t.armature.sortedSlots,l=0,h=o.length;l<h;++l){var u=o[l],s=r[u.name];if(s){var _=this._generateSlot(t,s,e);_&&(e.addSlot(_,u.parent.name),_._setDisplayIndex(u.displayIndex))}}}},e.prototype._replaceSlotDisplay=function(t,e,i,a){if(a<0&&(a=i.displayIndex),a>=0){var r=i.displayList;if(r.length<=a&&(r.length=a+1),i._replacedDisplayDatas.length<=a&&(i._replacedDisplayDatas.length=a+1),i._replacedDisplayDatas[a]=e,1===e.type){var n=this.buildArmature(e.path,t.dataName,null,t.textureAtlasName);r[a]=n}else{e.texture&&!t.textureAtlasName||(e.texture=this._getTextureData(t.textureAtlasName?t.textureAtlasName:t.dataName,e.path));var s=i.skinSlotData.displays;e.mesh||a<s.length&&s[a].mesh?r[a]=i.meshDisplay:r[a]=i.rawDisplay}i.displayList=r}},e.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);var a=this._dataParser.parseDragonBonesData(t,i);return this.addDragonBonesData(a,e),a},e.prototype.parseTextureAtlasData=function(t,e,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var r=this._generateTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,r,a),this._generateTextureAtlasData(r,e),this.addTextureAtlasData(r,i),r},e.prototype.getDragonBonesData=function(t){return this._dragonBonesDataMap[t]},e.prototype.addDragonBonesData=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);i=i||e.name,i?this._dragonBonesDataMap[i]?console.warn("Same name data.",i):this._dragonBonesDataMap[i]=e:console.warn("Unnamed data.")},e.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0);var i=this._dragonBonesDataMap[t];i&&(e&&i.returnToPool(),delete this._dragonBonesDataMap[t])},e.prototype.getTextureAtlasData=function(t){return this._textureAtlasDataMap[t]},e.prototype.addTextureAtlasData=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);if(i=i||e.name){var a=this._textureAtlasDataMap[i]?this._textureAtlasDataMap[i]:this._textureAtlasDataMap[i]=[];a.indexOf(e)<0&&a.push(e)}else console.warn("Unnamed data.")},e.prototype.removeTextureAtlasData=function(t,e){void 0===e&&(e=!0);var i=this._textureAtlasDataMap[t];if(i){if(e)for(var a=0,r=i.length;a<r;++a)i[a].returnToPool();delete this._textureAtlasDataMap[t]}},e.prototype.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBonesDataMap[e].returnToPool(),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=this._textureAtlasDataMap[e],a=0,r=i.length;a<r;++a)i[a].returnToPool();delete this._textureAtlasDataMap[e]}},e.prototype.buildArmature=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===a&&(a=null);var r={};if(this._fillBuildArmaturePackage(r,e,t,i,a)){var n=this._generateArmature(r);return this._buildBones(r,n),this._buildSlots(r,n),n.invalidUpdate(null,!0),n.advanceTime(0),n}return console.warn("No armature data.",t,e?e:""),null},e.prototype.copyAnimationsToArmature=function(e,i,a,r,n){void 0===a&&(a=null),void 0===r&&(r=null),void 0===n&&(n=!0);var s={};if(this._fillBuildArmaturePackage(s,r,i,a,null)){var o=s.armature;if(n)e.animation.animations=o.animations;else{var l={};for(var h in e.animation.animations)l[h]=e.animation.animations[h];for(var h in o.animations)l[h]=o.animations[h];e.animation.animations=l}if(s.skin){for(var u=e.getSlots(),_=0,f=u.length;_<f;++_)for(var c=u[_],m=c.displayList,p=0,d=m.length;p<d;++p){var y=m[p];if(y instanceof t.Armature){var g=s.skin.getSlot(c.name).displays;if(p<g.length){var v=g[p];1===v.type&&this.copyAnimationsToArmature(y,v.path,a,r,n)}}}return!0}}return!1},e.prototype.replaceSlotDisplay=function(t,e,i,a,r,n){void 0===n&&(n=-1);var s={};if(this._fillBuildArmaturePackage(s,t,e,null,null)){var o=s.skin.getSlot(i);if(o)for(var l=0,h=o.displays.length;l<h;++l){var u=o.displays[l];if(u.name===a){this._replaceSlotDisplay(s,u,r,n);break}}}},e.prototype.replaceSlotDisplayList=function(t,e,i,a){var r={};if(this._fillBuildArmaturePackage(r,t,e,null,null)){var n=r.skin.getSlot(i);if(n)for(var s=0,o=n.displays.length;s<o;++s){var l=n.displays[s];this._replaceSlotDisplay(r,l,a,s)}}},e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},e}();e._defaultParser=null,t.BaseFactory=e}(i||(i={})),e.default=i},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=i(4),h=a(l),u=function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._armature=null,t._debugDrawer=null,t}return s(e,t),o(e,[{key:"_onClear",value:function(){this._debugDrawer&&this._debugDrawer.destroy(!0),this._armature=null,this._debugDrawer=null,this.destroy()}},{key:"_dispatchEvent",value:function(t,e){this.emit(t,e)}},{key:"_debugDraw",value:function(t){if(!this._debugDrawer){this._debugDrawer=new Tiny.Sprite;var e=new Tiny.Graphics;this._debugDrawer.addChild(e)}if(t){this.addChild(this._debugDrawer);var i=this._debugDrawer.getChildAt(0);i.clear();for(var a=this._armature.getBones(),r=0,n=a.length;r<n;++r){var s=a[r],o=s.boneData.length,l=s.globalTransformMatrix.tx,u=s.globalTransformMatrix.ty,_=l+s.globalTransformMatrix.a*o,f=u+s.globalTransformMatrix.b*o;i.lineStyle(2,s.ik?16711680:65535,.7),i.moveTo(l,u),i.lineTo(_,f),i.lineStyle(0,0,0),i.beginFill(65535,.7),i.drawCircle(l,u,3),i.endFill()}for(var c=this._armature.getSlots(),m=0,p=c.length;m<p;++m){var d=c[m],y=d.boundingBoxData;if(y){var g=this._debugDrawer.getChildByName(d.name);switch(g||(g=new Tiny.Graphics,g.name=d.name,this._debugDrawer.addChild(g)),g.clear(),g.beginFill(16711935,.3),y.type){case h.default.Rectangle:g.drawRect(.5*-y.width,.5*-y.height,y.width,y.height);break;case h.default.Ellipse:g.drawEllipse(.5*-y.width,.5*-y.height,y.width,y.height);break;case h.default.Polygon:for(var v=y.vertices,b=0,T=y.vertices.length;b<T;b+=2)0===b?g.moveTo(v[b],v[b+1]):g.lineTo(v[b],v[b+1])}g.endFill(),d._updateTransformAndMatrix(),d.updateGlobalTransform();var D=d.global;g.setTransform(D.x,D.y,D.scaleX,D.scaleY,D.skewX,0,D.skewY-D.skewX,d._pivotX,d._pivotY)}else{var O=this._debugDrawer.getChildByName(d.name);O&&this._debugDrawer.removeChild(O)}}}else this._debugDrawer&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer)}},{key:"hasEvent",value:function(t){return this.listeners(t,!0)}},{key:"addEvent",value:function(t,e,i){this.addListener(t,e,i)}},{key:"removeEvent",value:function(t,e,i){this.removeListener(t,e,i)}},{key:"dispose",value:function(){this._armature&&(this._armature.dispose(),this._armature=null)}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this.animation.play(t,e)}},{key:"armature",get:function(){return this._armature}},{key:"animation",get:function(){return this._armature.animation}},{key:"debugDraw",get:function(){return this.armature.debugDraw},set:function(t){this.armature.debugDraw=t}}]),e}(Tiny.Container);e.default=u},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={None:-1,Rectangle:0,Ellipse:1,Polygon:2};e.default=i},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function t(e,i,a){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,a)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(a)},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),h=i(2),u=a(h),_=i(6),f=a(_),c=u.default.BaseObject,m=u.default.TextureAtlasData,p=function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.texture=null,t}return s(e,t),l(e,null,[{key:"toString",value:function(){return"[class TinyTextureAtlasData]"}}]),l(e,[{key:"_onClear",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_onClear",this).call(this),this.texture,this.texture=null}},{key:"generateTexture",value:function(){return c.borrowObject(f.default)}}]),e}(m);e.default=p},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function t(e,i,a){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,a)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(a)},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),h=i(2),u=a(h),_=u.default.TextureData,f=function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.texture=null,t}return s(e,t),l(e,null,[{key:"toString",value:function(){return"[class TinyTextureData]"}}]),l(e,[{key:"_onClear",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_onClear",this).call(this),this.texture&&this.texture.destroy(),this.texture=null}}]),e}(_);e.default=f},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=function t(e,i,a){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,a)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(a)},h=i(2),u=a(h),_=i(8),f=a(_),c=i(5),m=a(c),p=u.default.BaseObject,d=u.default.Slot,y=function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._renderDisplay=null,t._updateTransform="3"===Tiny.VERSION[0]?t._updateTransformV3:t._updateTransformV4,t}return s(e,t),o(e,[{key:"_onClear",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_onClear",this).call(this),this._renderDisplay=null}},{key:"_initDisplay",value:function(t){}},{key:"_disposeDisplay",value:function(t){t.destroy()}},{key:"_onUpdateDisplay",value:function(){this._renderDisplay=this._display?this._display:this._rawDisplay}},{key:"_addDisplay",value:function(){var t=this._armature.display;t.addChild(this._renderDisplay)}},{key:"_replaceDisplay",value:function(t){var e=this._armature.display,i=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,i),e.removeChild(i)}},{key:"_removeDisplay",value:function(){this._renderDisplay.parent.removeChild(this._renderDisplay)}},{key:"_updateZOrder",value:function(){var t=this._armature.display,e=t.getChildIndex(this._renderDisplay);e!==this._zOrder&&t.addChildAt(this._renderDisplay,this._zOrder)}},{key:"_updateVisible",value:function(){this._renderDisplay.visible=this._parent.visible}},{key:"_updateBlendMode",value:function(){switch(this._blendMode){case f.default.Normal:this._renderDisplay.blendMode=Tiny.BLEND_MODES.NORMAL;break;case f.default.Add:this._renderDisplay.blendMode=Tiny.BLEND_MODES.ADD;break;case f.default.Darken:this._renderDisplay.blendMode=Tiny.BLEND_MODES.DARKEN;break;case f.default.Difference:this._renderDisplay.blendMode=Tiny.BLEND_MODES.DIFFERENCE;break;case f.default.HardLight:this._renderDisplay.blendMode=Tiny.BLEND_MODES.HARD_LIGHT;break;case f.default.Lighten:this._renderDisplay.blendMode=Tiny.BLEND_MODES.LIGHTEN;break;case f.default.Multiply:this._renderDisplay.blendMode=Tiny.BLEND_MODES.MULTIPLY;break;case f.default.Overlay:this._renderDisplay.blendMode=Tiny.BLEND_MODES.OVERLAY;break;case f.default.Screen:this._renderDisplay.blendMode=Tiny.BLEND_MODES.SCREEN}}},{key:"_updateColor",value:function(){this._renderDisplay.alpha=this._colorTransform.alphaMultiplier}},{key:"_updateFrame",value:function(){var t=this._meshData&&this._display===this._meshDisplay,e=this._textureData;if(this._displayIndex>=0&&this._display&&e){var i=e.parent;this._armature.replacedTexture&&this._displayData&&i===this._displayData.texture.parent&&(i=this._armature._replaceTextureAtlasData,i||(i=p.borrowObject(m.default),i.copyFrom(e.parent),i.texture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=i),e=i.getTexture(e.name));var a=i.texture;if(a){if(e.texture||(e.texture=new Tiny.Texture(a,e.region,e.region,new Tiny.Rectangle(0,0,e.region.width,e.region.height),e.rotated)),t){var r=this._renderDisplay,n=i.width>0?i.width:a.width,s=i.height>0?i.height:a.height;r.uvs=new Float32Array(this._meshData.uvs),r.vertices=new Float32Array(this._meshData.vertices),r.indices=new Uint16Array(this._meshData.vertexIndices);for(var o=0,l=r.uvs.length;o<l;o+=2){var h=r.uvs[o],u=r.uvs[o+1];r.uvs[o]=(e.region.x+h*e.region.width)/n,r.uvs[o+1]=(e.region.y+u*e.region.height)/s}r.texture=e.texture,r.dirty++}else{var _=this._renderDisplay;_.texture=e.texture}return void this._updateVisible()}}if(t){var f=this._renderDisplay;f.texture=null,f.x=0,f.y=0,f.visible=!1}else{var c=this._renderDisplay;c.texture=null,c.x=0,c.y=0,c.visible=!1}}},{key:"_updateMesh",value:function(){var t=this._renderDisplay,e=this._ffdVertices.length>0;if(this._meshData.skinned)for(var i=0,a=0,r=this._meshData.vertices.length;i<r;i+=2){for(var n=i/2,s=this._meshData.boneIndices[n],o=this._meshData.boneVertices[n],l=this._meshData.weights[n],h=0,u=0,_=0,f=s.length;_<f;++_){var c=this._meshBones[s[_]],m=c.globalTransformMatrix,p=l[_],d=0,y=0;e?(d=o[2*_]+this._ffdVertices[a],y=o[2*_+1]+this._ffdVertices[a+1]):(d=o[2*_],y=o[2*_+1]),h+=(m.a*d+m.c*y+m.tx)*p,u+=(m.b*d+m.d*y+m.ty)*p,a+=2}t.vertices[i]=h,t.vertices[i+1]=u}else if(e)for(var g=this._meshData.vertices,v=0,b=this._meshData.vertices.length;v<b;v+=2){var T=g[v]+this._ffdVertices[v],D=g[v+1]+this._ffdVertices[v+1];t.vertices[v]=T,t.vertices[v+1]=D}}},{key:"_updateTransform",value:function(t){throw new Error}},{key:"_updateTransformV3",value:function(t){if(t)this._renderDisplay.setTransform(0,0,1,1,0,0,0,0,0);else{this.updateGlobalTransform();var e=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),i=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY),a=this.global;this._renderDisplay.setTransform(e,i,a.scaleX,a.scaleY,a.skewX,0,a.skewY-a.skewX)}}},{key:"_updateTransformV4",value:function(t){if(t)this._renderDisplay.setTransform(0,0,1,1,0,0,0,0,0);else{this.updateGlobalTransform();var e=this.global;this._renderDisplay.setTransform(e.x,e.y,e.scaleX,e.scaleY,e.skewX,0,e.skewY-e.skewX,this._pivotX,this._pivotY)}}}],[{key:"toString",value:function(){return"[class TinySlot]"}}]),e}(d);e.default=y},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={None:-1,Normal:0,Add:1,Alpha:2,Darken:3,Difference:4,Erase:5,HardLight:6,Invert:7,Layer:8,Lighten:9,Multiply:10,Overlay:11,Screen:12,Subtract:13};e.default=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={None:-1,Image:0,Armature:1,Mesh:2,BoundingBox:3};e.default=i},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=i(2),h=a(l),u=i(3),_=a(u),f=i(5),c=a(f),m=i(7),p=a(m),d=i(9),y=a(d),g=i(11),v=h.default.BaseObject,b=h.default.BaseFactory,T=h.default.WorldClock,D=h.default.Armature,O=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return e._eventManager||(e._eventManager=new _.default,e._clock=new T,Tiny.ticker.shared.add(e._clockHandler,e)),i}return s(e,t),o(e,[{key:"_generateTextureAtlasData",value:function(t,e){return t?t.texture=e:t=v.borrowObject(c.default),t}},{key:"_generateArmature",value:function(t){var i=v.borrowObject(D),a=new _.default;return a._armature=i,i._init(t.armature,t.skin,a,a,e._eventManager),i}},{key:"_generateSlot",value:function(t,e,i){var a=e.slot,r=v.borrowObject(p.default),n=[];r._init(e,new Tiny.Sprite,new g.Mesh(null,null,null,null,g.Mesh.DRAW_MODES.TRIANGLES));for(var s=0,o=e.displays.length;s<o;++s){var l=e.displays[s];switch(l.type){case y.default.Image:l.texture||(l.texture=this._getTextureData(t.dataName,l.path)),t.textureAtlasName&&(r._textureDatas[s]=this._getTextureData(t.textureAtlasName,l.path)),n[s]=r.rawDisplay;break;case y.default.Mesh:l.texture||(l.texture=this._getTextureData(t.dataName,l.path)),t.textureAtlasName&&(r._textureDatas[s]=this._getTextureData(t.textureAtlasName,l.path)),!l.mesh&&l.share&&(l.mesh=e.getMesh(l.share)),n[s]=r.meshDisplay;break;case y.default.Armature:var h=this.buildArmature(l.path,t.dataName,null,t.textureAtlasName);if(h){if(h.inheritAnimation=l.inheritAnimation,!h.inheritAnimation){var u=a.actions.length>0?a.actions:h.armatureData.actions;
if(u.length>0)for(var _=0,f=u.length;_<f;++_)h._bufferAction(u[_]);else h.animation.play()}l.armature=h.armatureData}n[s]=h;break;default:n[s]=null}}return r._setDisplayList(n),r}},{key:"buildArmatureDisplay",value:function(t,i,a,r){var n=this.buildArmature(t,i,a,r);if(n){var s=n.display;return e._clock.add(n),s}return null}},{key:"getTextureDisplay",value:function(t,e){var i=this._getTextureData(e,t);if(i){if(!i.texture){var a=i.parent.texture,r=new Tiny.Rectangle(0,0,i.region.width,i.region.height);i.texture=new Tiny.Texture(a,i.region,i.region,r,i.rotated)}return new Tiny.Sprite(i.texture)}return null}},{key:"eventManater",get:function(){return e._eventManager}}],[{key:"_clockHandler",value:function(t){e._clock.advanceTime(-1)}},{key:"factory",get:function(){return e._factory||(e._factory=new e),e._factory}},{key:"clock",get:function(){return e._clock}}]),e}(b);O._factory=null,O._eventManager=null,O._clock=null,e.default=O},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(12);Object.defineProperty(e,"Mesh",{enumerable:!0,get:function(){return a(r).default}});var n=i(13);Object.defineProperty(e,"MeshRenderer",{enumerable:!0,get:function(){return a(n).default}});var s=i(14);Object.defineProperty(e,"CanvasMeshRenderer",{enumerable:!0,get:function(){return a(s).default}});var o=i(15);Object.defineProperty(e,"Plane",{enumerable:!0,get:function(){return a(o).default}});var l=i(16);Object.defineProperty(e,"NineSlicePlane",{enumerable:!0,get:function(){return a(l).default}});var h=i(17);Object.defineProperty(e,"Rope",{enumerable:!0,get:function(){return a(h).default}})},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),s=new Tiny.Point,o=new Tiny.Polygon,l=function(t){function e(t,r,n,s,o){i(this,e);var l=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return l._texture=t,l.vertices=r||new Float32Array([0,0,100,0,100,100,0,100]),l.uvs=n||new Float32Array([0,0,1,0,1,1,0,1]),l.indices=s||new Uint16Array([0,1,3,2]),l.drawMode=o||e.DRAW_MODES.TRIANGLE_MESH,l.dirty=0,l.indexDirty=0,l.blendMode=Tiny.BLEND_MODES.NORMAL,l.canvasPadding=0,l.shader=null,l.tintRgb=new Float32Array([1,1,1]),l._glDatas={},l._uvTransform=new Tiny.TextureTransform(t),l.uploadUvTransform=!1,l.pluginName="mesh",l}return r(e,t),n(e,[{key:"_renderWebGL",value:function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}},{key:"_renderCanvas",value:function(t){this.refresh(),t.plugins[this.pluginName].render(this)}},{key:"_onTextureUpdate",value:function(){this._uvTransform.texture=this._texture,this.refresh()}},{key:"multiplyUvs",value:function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)}},{key:"refresh",value:function(t){this._uvTransform.update(t)&&this._refresh()}},{key:"_refresh",value:function(){}},{key:"_calculateBounds",value:function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)}},{key:"containsPoint",value:function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,s);for(var i=this.vertices,a=o.points,r=this.indices,n=this.indices.length,l=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,h=0;h+2<n;h+=l){var u=2*r[h],_=2*r[h+1],f=2*r[h+2];if(a[0]=i[u],a[1]=i[u+1],a[2]=i[_],a[3]=i[_+1],a[4]=i[f],a[5]=i[f+1],o.contains(s.x,s.y))return!0}return!1}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return Tiny.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=Tiny.hex2rgb(t,this.tintRgb)}}]),e}(Tiny.Container);l.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1},e.default=l},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=i(12),h=a(l),u=Tiny.glCore,_=Tiny.Matrix.IDENTITY,f=function(t){function e(t){r(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.shader=null,i}return s(e,t),o(e,[{key:"onContextChange",value:function(){var t=this.renderer.gl;this.shader=new Tiny.Shader(t,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","\nvarying vec2 vTextureCoord;\nuniform float alpha;\nuniform vec3 tint;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vec4(tint * alpha, alpha);\n}\n      ")}},{key:"render",value:function(t){var e=this.renderer,i=e.gl,a=t._texture;if(a.valid){var r=t._glDatas[e.CONTEXT_UID];r||(e.bindVao(null),r={shader:this.shader,vertexBuffer:u.GLBuffer.createVertexBuffer(i,t.vertices,i.STREAM_DRAW),uvBuffer:u.GLBuffer.createVertexBuffer(i,t.uvs,i.STREAM_DRAW),indexBuffer:u.GLBuffer.createIndexBuffer(i,t.indices,i.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty},r.vao=new u.VertexArrayObject(i).addIndex(r.indexBuffer).addAttribute(r.vertexBuffer,r.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(r.uvBuffer,r.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=r),e.bindVao(r.vao),t.dirty!==r.dirty&&(r.dirty=t.dirty,r.uvBuffer.upload(t.uvs)),t.indexDirty!==r.indexDirty&&(r.indexDirty=t.indexDirty,r.indexBuffer.upload(t.indices)),r.vertexBuffer.upload(t.vertices),e.bindShader(r.shader),r.shader.uniforms.uSampler=e.bindTexture(a),e.state.setBlendMode(t.blendMode),r.shader.uniforms.uTransform&&(t.uploadUvTransform?r.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):r.shader.uniforms.uTransform=_.toArray(!0)),r.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),r.shader.uniforms.alpha=t.worldAlpha,r.shader.uniforms.tint=t.tintRgb;var n=t.drawMode===h.default.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;r.vao.draw(n,t.indices.length,0)}}}]),e}(Tiny.ObjectRenderer);Tiny.WebGLRenderer.registerPlugin("mesh",f),e.default=f},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),s=i(12),o=a(s),l=function(){function t(e){r(this,t),this.renderer=e}return n(t,[{key:"render",value:function(t){var e=this.renderer,i=e.context,a=t.worldTransform,r=e.resolution;e.roundPixels?i.setTransform(a.a*r,a.b*r,a.c*r,a.d*r,a.tx*r|0,a.ty*r|0):i.setTransform(a.a*r,a.b*r,a.c*r,a.d*r,a.tx*r,a.ty*r),e.setBlendMode(t.blendMode),t.drawMode===o.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)}},{key:"_renderTriangleMesh",value:function(t){for(var e=t.vertices.length/2,i=0;i<e-2;i++){var a=2*i;this._renderDrawTriangle(t,a,a+2,a+4)}}},{key:"_renderTriangles",value:function(t){for(var e=t.indices,i=e.length,a=0;a<i;a+=3){var r=2*e[a],n=2*e[a+1],s=2*e[a+2];this._renderDrawTriangle(t,r,n,s)}}},{key:"_renderDrawTriangle",value:function(t,e,i,a){var r=this.renderer.context,n=t.uvs,s=t.vertices,o=t._texture;if(o.valid){var l=o.baseTexture,h=l.source,u=l.width,_=l.height,f=void 0,c=void 0,m=void 0,p=void 0,d=void 0,y=void 0;if(t.uploadUvTransform){var g=t._uvTransform.mapCoord;f=(n[e]*g.a+n[e+1]*g.c+g.tx)*l.width,c=(n[i]*g.a+n[i+1]*g.c+g.tx)*l.width,m=(n[a]*g.a+n[a+1]*g.c+g.tx)*l.width,p=(n[e]*g.b+n[e+1]*g.d+g.ty)*l.height,d=(n[i]*g.b+n[i+1]*g.d+g.ty)*l.height,y=(n[a]*g.b+n[a+1]*g.d+g.ty)*l.height}else f=n[e]*l.width,c=n[i]*l.width,m=n[a]*l.width,p=n[e+1]*l.height,d=n[i+1]*l.height,y=n[a+1]*l.height;var v=s[e],b=s[i],T=s[a],D=s[e+1],O=s[i+1],x=s[a+1];if(t.canvasPadding>0){var S=t.canvasPadding/t.worldTransform.a,w=t.canvasPadding/t.worldTransform.d,E=(v+b+T)/3,A=(D+O+x)/3,M=v-E,P=D-A,k=Math.sqrt(M*M+P*P);v=E+M/k*(k+S),D=A+P/k*(k+w),M=b-E,P=O-A,k=Math.sqrt(M*M+P*P),b=E+M/k*(k+S),O=A+P/k*(k+w),M=T-E,P=x-A,k=Math.sqrt(M*M+P*P),T=E+M/k*(k+S),x=A+P/k*(k+w)}r.save(),r.beginPath(),r.moveTo(v,D),r.lineTo(b,O),r.lineTo(T,x),r.closePath(),r.clip();var B=f*d+p*m+c*y-d*m-p*c-f*y,C=v*d+p*T+b*y-d*T-p*b-v*y,F=f*b+v*m+c*T-b*m-v*c-f*T,I=f*d*T+p*b*m+v*c*y-v*d*m-p*c*T-f*b*y,N=D*d+p*x+O*y-d*x-p*O-D*y,R=f*O+D*m+c*x-O*m-D*c-f*x,j=f*d*x+p*O*m+D*c*y-D*d*m-p*c*x-f*O*y;r.transform(C/B,N/B,F/B,R/B,I/B,j/B),r.drawImage(h,0,0,u*l.resolution,_*l.resolution,0,0,u,_),r.restore()}}},{key:"renderMeshFlat",value:function(t){var e=this.renderer.context,i=t.vertices,a=i.length/2;e.beginPath();for(var r=1;r<a-2;++r){var n=2*r,s=i[n],o=i[n+1],l=i[n+2],h=i[n+3],u=i[n+4],_=i[n+5];e.moveTo(s,o),e.lineTo(l,h),e.lineTo(u,_)}e.fillStyle="#FF0000",e.fill(),e.closePath()}},{key:"destroy",value:function(){this.renderer=null}}]),t}();Tiny.CanvasRenderer.registerPlugin("mesh",l),e.default=l},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=i(12),h=a(l),u=function(t){function e(t,i,a){r(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s._ready=!0,s.verticesX=i||10,s.verticesY=a||10,s.drawMode=h.default.DRAW_MODES.TRIANGLES,s.refresh(),s}return s(e,t),o(e,[{key:"_refresh",value:function(){for(var t=this._texture,e=this.verticesX*this.verticesY,i=[],a=[],r=[],n=[],s=this.verticesX-1,o=this.verticesY-1,l=t.width/s,h=t.height/o,u=0;u<e;u++){var _=u%this.verticesX,f=u/this.verticesX|0;i.push(_*l,f*h),r.push(_/s,f/o)}for(var c=s*o,m=0;m<c;m++){var p=m%s,d=m/s|0,y=d*this.verticesX+p,g=d*this.verticesX+p+1,v=(d+1)*this.verticesX+p,b=(d+1)*this.verticesX+p+1;n.push(y,g,v),n.push(g,b,v)}this.vertices=new Float32Array(i),this.uvs=new Float32Array(r),this.colors=new Float32Array(a),this.indices=new Uint16Array(n),this.indexDirty=!0,this.multiplyUvs()}},{key:"_onTextureUpdate",value:function(){h.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()}}]),e}(h.default);e.default=u},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=function t(e,i,a){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,a)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(a)},h=i(15),u=a(h),_=10,f=function(t){function e(t,i,a,s,o){r(this,e);var l=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,4,4));return l._origWidth=t.orig.width,l._origHeight=t.orig.height,l._width=l._origWidth,l._height=l._origHeight,l.leftWidth="undefined"!=typeof i?i:_,l.rightWidth="undefined"!=typeof s?s:_,l.topHeight="undefined"!=typeof a?a:_,l.bottomHeight="undefined"!=typeof o?o:_,l.refresh(!0),l}return s(e,t),o(e,[{key:"updateHorizontalVertices",value:function(){var t=this.vertices;t[9]=t[11]=t[13]=t[15]=this._topHeight,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight,t[25]=t[27]=t[29]=t[31]=this._height}},{key:"updateVerticalVertices",value:function(){var t=this.vertices;t[2]=t[10]=t[18]=t[26]=this._leftWidth,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth,t[6]=t[14]=t[22]=t[30]=this._width}},{key:"_renderCanvas",value:function(t){var e=t.context;e.globalAlpha=this.worldAlpha;var i=this.worldTransform,a=t.resolution;t.roundPixels?e.setTransform(i.a*a,i.b*a,i.c*a,i.d*a,i.tx*a|0,i.ty*a|0):e.setTransform(i.a*a,i.b*a,i.c*a,i.d*a,i.tx*a,i.ty*a);var r=this._texture.baseTexture,n=r.source,s=r.width,o=r.height;this.drawSegment(e,n,s,o,0,1,10,11),this.drawSegment(e,n,s,o,2,3,12,13),this.drawSegment(e,n,s,o,4,5,14,15),this.drawSegment(e,n,s,o,8,9,18,19),this.drawSegment(e,n,s,o,10,11,20,21),this.drawSegment(e,n,s,o,12,13,22,23),this.drawSegment(e,n,s,o,16,17,26,27),this.drawSegment(e,n,s,o,18,19,28,29),this.drawSegment(e,n,s,o,20,21,30,31)}},{key:"drawSegment",value:function(t,e,i,a,r,n,s,o){var l=this.uvs,h=this.vertices,u=(l[s]-l[r])*i,_=(l[o]-l[n])*a,f=h[s]-h[r],c=h[o]-h[n];u<1&&(u=1),_<1&&(_=1),f<1&&(f=1),c<1&&(c=1),t.drawImage(e,l[r]*i,l[n]*a,u,_,h[r],h[n],f,c)}},{key:"_refresh",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_refresh",this).call(this);var t=this.uvs,i=this._texture;this._origWidth=i.orig.width,this._origHeight=i.orig.height;var a=1/this._origWidth,r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=a*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-a*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty=!0,this.multiplyUvs()}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),e}(u.default);e.default=f},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),l=i(12),h=a(l),u=function(t){function e(t,i){r(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.points=i,a.vertices=new Float32Array(4*i.length),a.uvs=new Float32Array(4*i.length),a.colors=new Float32Array(2*i.length),a.indices=new Uint16Array(2*i.length),a.autoUpdate=!0,a.refresh(),a}return s(e,t),o(e,[{key:"_refresh",value:function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,i=this.indices,a=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,a[0]=1,a[1]=1,i[0]=0,i[1]=1;for(var r=t.length,n=1;n<r;n++){var s=4*n,o=n/(r-1);e[s]=o,e[s+1]=0,e[s+2]=o,e[s+3]=1,s=2*n,a[s]=1,a[s+1]=1,s=2*n,i[s]=s,i[s+1]=s+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}}},{key:"refreshVertices",value:function(){var t=this.points;if(!(t.length<1))for(var e=t[0],i=void 0,a=0,r=0,n=this.vertices,s=t.length,o=0;o<s;o++){var l=t[o],h=4*o;i=o<t.length-1?t[o+1]:l,r=-(i.x-e.x),a=i.y-e.y;var u=10*(1-o/(s-1));u>1&&(u=1);var _=Math.sqrt(a*a+r*r),f=this._texture.height/2;a/=_,r/=_,a*=f,r*=f,n[h]=l.x+a,n[h+1]=l.y+r,n[h+2]=l.x-a,n[h+3]=l.y-r,e=l}}},{key:"updateTransform",value:function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()}}]),e}(h.default);e.default=u},function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}/**!
	 * @author 清扬陌客<qingyangmoke@qq.com>
	 * 增加一些静态方法 简化操作
	 */
function r(t){return h.parseDragonBonesData(t)}function n(t,e){return h.parseTextureAtlasData(t,e)}function s(t,e,i,a){return h.buildArmatureDisplay(t,e,i,a)}Object.defineProperty(e,"__esModule",{value:!0}),e.buildArmatureDisplay=e.addTextureAtlasData=e.addDragonBonesData=void 0;var o=i(10),l=a(o),h=l.default.factory;e.addDragonBonesData=r,e.addTextureAtlasData=n,e.buildArmatureDisplay=s}])});