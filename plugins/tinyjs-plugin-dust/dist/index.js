/*!
 * tinyjs-plugin-dust
 * Description: Dust is a quick and easy particle effects engine
 * Author: fangjun.yfj
 * Version: v0.0.3
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Dust=t():(e.Tiny=e.Tiny||{},e.Tiny.Dust=t())}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="/dist",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(t,n,a,s,o){if(i(this,e),this.x=t||0,this.y=n||0,this.spriteFn=a,this.container=s||new Tiny.Container,!a)throw new Error("Sprite is needed.");o=o||{},this.number=o.number||20,this.gravity=o.gravity||0,this.randomSpacing=!!Tiny.isUndefined(o.randomSpacing)||o.randomSpacing,this.minAngle=o.minAngle||0,this.maxAngle=o.maxAngle||6.28,this.minSize=o.minSize||4,this.maxSize=o.maxSize||16,this.minSpeed=o.minSpeed||.3,this.maxSpeed=o.maxSpeed||3,this.minScaleSpeed=o.minScaleSpeed||.01,this.maxScaleSpeed=o.maxScaleSpeed||.05,this.minAlphaSpeed=o.minAlphaSpeed||.02,this.maxAlphaSpeed=o.maxAlphaSpeed||.02,this.minRotationSpeed=o.minRotationSpeed||.01,this.maxRotationSpeed=o.maxRotationSpeed||.03,this.particles=[],this.angles=[];var r=this,l=void 0,p=(this.maxAngle-this.minAngle)/(this.number-1);e.globalParticles.push(this.particles);for(var h=0;h<this.number;h++)this.randomSpacing?(l=Tiny.randomFloat(this.minAngle,this.maxAngle),this.angles.push(l)):(void 0===l&&(l=this.minAngle),this.angles.push(l),l+=p);this.angles.forEach(function(e){return r.makeParticle(e)})}return n(e,[{key:"makeParticle",value:function(e){var t=this.spriteFn(),i=this.gravity,n=this.particles,a=this.container;t.totalFrames>0&&t.gotoAndStop(Tiny.randomInt(0,t.totalFrames-1));var s=Tiny.randomInt(this.minSize,this.maxSize);t.width=s,t.height=s,t.x=this.x,t.y=this.y,t.scaleSpeed=Tiny.randomFloat(this.minScaleSpeed,this.maxScaleSpeed),t.alphaSpeed=Tiny.randomFloat(this.minAlphaSpeed,this.maxAlphaSpeed),t.rotationSpeed=Tiny.randomFloat(this.minRotationSpeed,this.maxRotationSpeed);var o=Tiny.randomFloat(this.minSpeed,this.maxSpeed);t.vx=o*Math.cos(e),t.vy=o*Math.sin(e),n.push(t),a.addChild(t),t.updateParticle=function(){t.vy+=i,t.x+=t.vx,t.y+=t.vy,t.scale.x-t.scaleSpeed>0&&(t.scale.x-=t.scaleSpeed),t.scale.y-t.scaleSpeed>0&&(t.scale.y-=t.scaleSpeed),t.rotation+=t.rotationSpeed,t.alpha-=t.alphaSpeed,t.alpha<=0&&(a.removeChild(t),n.splice(n.indexOf(t),1))}}},{key:"update",value:function(){if(e.globalParticles.length>0)for(var t=e.globalParticles.length-1;t>=0;t--){var i=e.globalParticles[t];if(i.length>0)for(var n=i.length-1;n>=0;n--){var a=i[n];a.updateParticle()}else e.globalParticles.splice(e.globalParticles.indexOf(i),1)}}}]),e}();a.globalParticles=[],e.exports=a}])});